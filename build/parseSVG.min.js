/**
*
*   Parse SVG utility (part of Geometrize library)
*   https://github.com/foo123/Geometrize
*
**/
!function(e,t,s){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=s.call(e)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return s.moduleUri=t.uri,s.call(e)}):t in e||(e[t]=s.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[t]})}("undefined"!=typeof self?self:this,"parseSVG",function(){"use strict";var a=/<(\/)?([a-z0-9_\-:]+?)\b\s*([^<>]*)\/?>/im,n=/([a-z0-9_\-:]+?)\b\s*(=\s*"([^"]*)")?/im,s=/[MLHVCSQTAZ]/gi,i=/(matrix|scale|rotate|translate|skewX|skewY)\s*\(([^\(\)]*)\)/im,h=/-?(?:(?:\d+\.\d+)|(?:\.\d+)|(?:\d+))/g,o=Object.prototype.hasOwnProperty,d=(Math,{});function y(t){return t.trim()}function m(t){return parseFloat(t||"")||0}function l(e){var r={"stroke-width":1,stroke:1,"stroke-opacity":1,"stroke-linecap":1,"stroke-linejoin":1,fill:1,"fill-opacity":1,"fill-rule":1},a={"stroke-width":1,"stroke-opacity":1,"fill-opacity":1},s=y(e.style||"").split(";").reduce(function(t,e){var s=y(e).split(":"),e=y(s[0]),s=y(s.slice(1).join(":"));return o.call(r,e)&&(t[e]=1===a[e]?m(s):s),t},{});return Object.keys(r).forEach(function(t){o.call(e,t)&&(s[t]=(1===a[t]?m:y)(e[t]))}),s}function f(t){for(var e,s=y(t.transform||""),r=[];e=s.match(i);)r.push([y(e[1]).toLowerCase(),(y(e[2]).match(h)||[]).map(m)]),s=s.slice(e.index+e[0].length);return r.length?r:null}function c(t){var e=(t=y(String(t))).match(s),u=t.split(s),c=[0,0],p=c;return e?e.reduce(function(t,e,s){var r,a,n,i,o,l=e===e.toLowerCase(),f=(y(u[s+1]||"").match(h)||[]).map(m);switch(e.toUpperCase()){case"M":2<=f.length&&(c=[(l?c[0]:0)+f[0],(l?c[1]:0)+f[1]],p=c);break;case"H":for(;1<=f.length;)r=[c[0],c[1]],a=[(l?r[0]:0)+f.shift(),r[1]],c=a,t.push({type:"Line",points:[r,a],H:!0});break;case"V":for(;1<=f.length;)a=[(r=[c[0],c[1]])[0],(l?r[1]:0)+f.shift()],c=a,t.push({type:"Line",points:[r,a],V:!0});break;case"L":for(;2<=f.length;)r=[c[0],c[1]],a=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],c=a,t.push({type:"Line",points:[r,a]});break;case"A":for(;7<=f.length;)o={start:null,end:null,radiusX:f.shift(),radiusY:f.shift(),angle:f.shift(),largeArc:f.shift(),sweep:f.shift()},r=[c[0],c[1]],a=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],c=a,o.start=r,o.end=a,t.push({type:"Arc",params:o});break;case"Q":for(;4<=f.length;)r=[c[0],c[1]],a=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],n=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],c=n,t.push({type:"Quadratic",points:[r,a,n]});break;case"T":for(;2<=f.length;)o=t.length?t[t.length-1]:d,r=[c[0],c[1]],n=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],a="Quadratic"===o.type?[2*r[0]-o.points[1][0],2*r[1]-o.points[1][1]]:[r[0],r[1]],c=n,t.push({type:"Quadratic",points:[r,a,n],T:!0});break;case"C":for(;6<=f.length;)r=[c[0],c[1]],a=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],n=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],i=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],c=i,t.push({type:"Cubic",points:[r,a,n,i]});break;case"S":for(;4<=f.length;)o=t.length?t[t.length-1]:d,r=[c[0],c[1]],n=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],i=[(l?r[0]:0)+f.shift(),(l?r[1]:0)+f.shift()],a="Cubic"===o.type?[2*r[0]-o.points[2][0],2*r[1]-o.points[2][1]]:[r[0],r[1]],c=i,t.push({type:"Cubic",points:[r,a,n,i],S:!0});break;case"Z":r=[c[0],c[1]],a=[p[0],p[1]],p=c=a,t.push({type:"Line",points:[r,a],Z:!0})}return t},[]):[]}function p(t,e){if(!e||!e.parsed){if(t.tagName&&t.children)return(s=function(t){var e,s,r={};if(t.attributes)for(e=0,s=t.attributes.length;e<s;++e)r[t.attributes[e].name.toLowerCase()]=t.attributes[e].value;return r}(t)).style=l(s),s.transform=f(s),e.parsed=!0,{tag:t.tagName.toLowerCase(),atts:s,children:t.children};var s,r=e.index||0;return(t=(t=t.slice(r)).match(a))?(e.index=r+t.index+t[0].length,"/"===t[1]?{tag:t[2].toLowerCase(),end:!0}:((s=function(t){for(var e,s={};e=t.match(n);)s[e[1].toLowerCase()]=!e[3]||y(e[3]),t=t.slice(e.index+e[0].length);return s}(t[3])).style=l(s),s.transform=f(s),{tag:t[2].toLowerCase(),atts:s})):void 0}}function t(t){return function s(t,e,r){for(var a,n,i,o,l,f=[],u=r?1:0;a=p(t,e);)switch(a.tag){case"line":a.end||f.push({type:"Line",points:[[m(a.atts.x1),m(a.atts.y1)],[m(a.atts.x2),m(a.atts.y2)]],transform:a.atts.transform,style:a.atts.style});break;case"polyline":a.end||f.push({type:"Polyline",points:((a.atts.points||"").match(h)||[]).map(m).reduce(function(t,e,s){return s%2?t[(s-1)/2][1]=e:t.push([e,0]),t},[]),transform:a.atts.transform,style:a.atts.style});break;case"polygon":a.end||f.push({type:"Polygon",points:((a.atts.points||"").match(h)||[]).map(m).reduce(function(t,e,s){return s%2?t[(s-1)/2][1]=e:t.push([e,0]),t},[]),transform:a.atts.transform,style:a.atts.style});break;case"rect":a.end||(n=m(a.atts.x),i=m(a.atts.y),o=m(a.atts.width),l=m(a.atts.height),f.push({type:"Polygon",points:[[n,i],[n+o,i],[n+o,i+l],[n,i+l]],transform:a.atts.transform,style:a.atts.style}));break;case"circle":a.end||f.push({type:"Circle",params:{center:[m(a.atts.cx),m(a.atts.cy)],radius:m(a.atts.r)},transform:a.atts.transform,style:a.atts.style});break;case"ellipse":a.end||f.push({type:"Ellipse",params:{center:[m(a.atts.cx),m(a.atts.cy)],radiusX:m(a.atts.rx),radiusY:m(a.atts.ry),angle:0},transform:a.atts.transform,style:a.atts.style});break;case"path":a.end||f.push({type:"Path",nodes:c(a.atts.d||""),transform:a.atts.transform,style:a.atts.style});break;case"g":if(a.end){if("g"===r&&0==--u)return f}else"g"===r&&++u,f.push({type:"Group",nodes:a.children?[].reduce.call(a.children,function(t,e){return t.push.apply(t,s(e,{index:0},"g")),t},[]):s(t,e,"g"),transform:a.atts.transform,style:a.atts.style});break;case"svg":if(a.end){if("svg"===r&&0==--u)return f}else"svg"===r&&++u,f.push({type:"SVG",viewBox:a.atts.viewbox?(a.atts.viewbox.match(h)||[]).map(m):[0,0,0,0],nodes:a.children?[].reduce.call(a.children,function(t,e){return t.push.apply(t,s(e,{index:0},"svg")),t},[]):s(t,e,"svg")})}return f}(t.tagName?t:y(String(t)),{index:0})}return t.parsePath=c,t});