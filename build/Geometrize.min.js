/**
*   Geometrize
*   computational geometry and rendering library for JavaScript
*
*   @version 0.6.0 (2022-12-08 19:02:30)
*   https://github.com/foo123/Geometrize
*
**/
!function(t,n,e){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return e.moduleUri=n.uri,e.call(t)}):n in t||(t[n]=e.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"Geometrize",function(){"use strict";var p=Object.prototype.hasOwnProperty,t=Object.prototype.toString,v=Object.defineProperty,P=Math,G=P.abs,b=P.sqrt,l=P.pow,C=P.PI,$=2*C,r=1e-6,i=b(2),c=b(3),m={},a=function(){},y=("undefined"!=typeof global&&t.call(global),"undefined"!=typeof window&&"[object Window]"===t.call(window)),n={VERSION:"0.6.0",Math:{},Geometry:{}};function e(n,t,e){var r,i,s,o=p.call(t,"constructor")?t.constructor:function(){};for(r in n?(o.prototype=Object.create(n.prototype),o.prototype.$super=(i=n,s={},function(n,t){var e=":"+n;return 1===s[e]?(i.prototype.$super||a).call(this,n,t):(s[e]=1,t=("constructor"===n?i:i.prototype[n]||a).apply(this,t||[]),s[e]=0,t)})):o.prototype.$super=a,o.prototype.constructor=o,t)p.call(t,r)&&"constructor"!==r&&(o.prototype[r]=t[r]);if(e)for(r in e)p.call(e,r)&&(o[r]=e[r]);return o}var o={$changed:!1,$cb:null,dispose:function(){this.$cb=null},isChanged:function(n){return arguments.length?(this.$changed=!!n,this):this.$changed},onChange:function(n,t){var e,r=this;return!1===t&&(pt(n)||gt(n))?r.$cb&&-1!==(e=(gt(n)?r.$cb.map(function(n){return ct(n.id)}):r.$cb).indexOf(n))&&r.$cb.splice(e,1):pt(n)&&(r.$cb||(r.$cb=[]),-1===(e=r.$cb.indexOf(n))&&r.$cb.push(n)),r},triggerChange:function(){var t=this;return t.$cb&&t.$cb.forEach(function(n){n(t)}),t}},w=e(null,Kn(null,{constructor:function e(r){var i=this;return r instanceof e?r:i instanceof e?(r=+r||0,i.dispose=function(){r=null,e.prototype.dispose.call(i)},i.clone=function(){return new e(r)},i.val=function(n){if(arguments.length){n=n instanceof e?n.val():+n||0;var t=!Bn(r,n);return r=n,t&&!i.isChanged()&&(i.isChanged(!0),i.triggerChange()),i}return r},i.valueOf=function(){return r.valueOf()},i.toString=function(){return ct(r)},void i.isChanged(!0)):new e(r)},clone:null,val:null,valueOf:null,toString:null},o)),x=e(null,{constructor:function n(t,e,r,i,s,o,a,u,l){var c=this;return t instanceof n?t:c instanceof n?(xt(t)&&9<=t.length?(c.$00=ht(t[0]),c.$01=ht(t[1]),c.$02=ht(t[2]),c.$10=ht(t[3]),c.$11=ht(t[4]),c.$12=ht(t[5])):(c.$00=t,c.$01=e,c.$02=r,c.$10=i,c.$11=s,c.$12=o),c.$20=0,c.$21=0,void(c.$22=1)):new n(t,e,r,i,s,o,a,u,l)},$00:1,$01:0,$02:0,$10:0,$11:1,$12:0,$20:0,$21:0,$22:1,clone:function(){var n=this;return new x(n.$00,n.$01,n.$02,n.$10,n.$11,n.$12,0,0,1)},eq:function(n){if(n instanceof x){var t=this;return Bn(t.$00,n.$00)&&Bn(t.$01,n.$01)&&Bn(t.$02,n.$02)&&Bn(t.$10,n.$10)&&Bn(t.$11,n.$11)&&Bn(t.$12,n.$12)}return!1},add:function(n){var t=this;return n instanceof x?new x(t.$00+n.$00,t.$01+n.$01,t.$02+n.$02,t.$10+n.$10,t.$11+n.$11,t.$12+n.$12,0,0,1):(n=+n||0,new x(t.$00+n,t.$01+n,t.$02+n,t.$10+n,t.$11+n,t.$12+n,0,0,1))},mul:function(n){var t=this;return n instanceof x?new x(t.$00*n.$00+t.$01*n.$10+t.$02*n.$20,t.$00*n.$01+t.$01*n.$11+t.$02*n.$21,t.$00*n.$02+t.$01*n.$12+t.$02*n.$22,t.$10*n.$00+t.$11*n.$10+t.$12*n.$20,t.$10*n.$01+t.$11*n.$11+t.$12*n.$21,t.$10*n.$02+t.$11*n.$12+t.$12*n.$22,0,0,1):(n=+n||0,new x(t.$00*n,t.$01*n,t.$02*n,t.$10*n,t.$11*n,t.$12*n,0,0,1))},det:function(){var n=this;return n.$00*(n.$11*n.$22-n.$12*n.$21)+n.$01*(n.$12*n.$20-n.$10*n.$22)+n.$02*(n.$21*n.$10-n.$11*n.$20)},inv:function(){var n,t,e,r=this,i=r.$00,s=r.$01,o=r.$02,a=r.$10,u=r.$11,l=r.$12,c=i*u-s*a;return is_almost_zero(c)?null:new x(n=u/c,t=-s/c,-n*o-t*l,e=-a/c,r=i/c,-e*o-r*l,0,0,1)},transform:function(n,t){var e=this,r=n.x,i=n.y,n=e.$00*r+e.$01*i+e.$02,e=e.$10*r+e.$11*i+e.$12;return t?(t.x=n,t.y=e):t=new T(n,e),t},getTranslation:function(){return{x:this.$02,y:this.$12}},getRotationAngle:function(){return P.atan2(this.$10,this.$00)},getScale:function(){var n=this.$00,t=-this.$01,e=this.$10,r=this.$11;return{x:Ln(n)*Qn(n,e),y:Ln(r)*Qn(t,r)}},toArray:function(){var n=this;return[n.$00,n.$01,n.$02,n.$10,n.$11,n.$12,n.$20,n.$21,n.$22]},toSVG:function(){var n=this;return"matrix("+ct(n.$00)+" "+ct(n.$10)+" "+ct(n.$01)+" "+ct(n.$11)+" "+ct(n.$02)+" "+ct(n.$12)+")"},toCSS:function(){var n=this;return"matrix("+ct(n.$00)+","+ct(n.$10)+","+ct(n.$01)+","+ct(n.$11)+","+ct(n.$02)+","+ct(n.$12)+")"},toTex:function(){return x.arrayTex(this.toArray(),3,3)},toString:function(){return x.arrayString(this.toArray(),3,3)}},{eye:function(){return new x(1,0,0,0,1,0,0,0,1)},translate:function(n,t){return new x(1,0,+n||0,0,1,+t||0,0,0,1)},rotate:function(n,t,e){e=ht(e||0),t=ht(t||0),n=+n||0;var r=P.cos(n),n=P.sin(n);return new x(r,-n,t-r*t+n*e,n,r,e-r*e-n*t,0,0,1)},scale:function(n,t,e,r){return r=ht(r||0),e=ht(e||0),new x(n=+n||0,0,-n*e+e,0,t=+t||0,-t*r+r,0,0,1)},reflectX:function(){return new x(-1,0,0,0,1,0,0,0,1)},reflectY:function(){return new x(1,0,0,0,-1,0,0,0,1)},shearX:function(n){return new x(1,+n||0,0,0,1,0,0,0,1)},shearY:function(n){return new x(1,0,0,+n||0,1,0,0,0,1)},arrayTex:function(n,t,e){for(var r="\\begin{pmatrix}",i=0;i<t;++i)r+=n.slice(i*e,i*e+e).join("&"),i+1<t&&(r+="\\\\");return r+="\\end{pmatrix}"},arrayString:function(n,t,e){for(var r=n.reduce(function(n,t){return P.max(n,ct(t).length)},0),i="",s=0;s<t;++s)i+="["+n.slice(s*e,s*e+e).map(function(n){return ut(n,r)}).join(" ")+"]",s+1<t&&(i+="\n");return i},pointTex:function(n){return"\\begin{pmatrix}"+ct(n.x)+"\\\\"+ct(n.y)+"\\\\1\\end{pmatrix}"},pointString:function(n){var t=[n.x,n.y].reduce(function(n,t){return P.max(n,ct(t).length)},1);return"["+ut(n.x,t)+"]\n["+ut(n.y,t)+"]\n["+ut(1,t)+"]"}}),d=x.eye();n.Matrix=x;var h=/^#([0-9a-fA-F]{3,6})\b/,f=/^(rgba?)\b\s*\(([^\)]*)\)/i,g=/^(hsla?)\b\s*\(([^\)]*)\)/i,_=/^(hwba?)\b\s*\(([^\)]*)\)/i,k=/\s+|,/gm,S=/\/\s*(\d*?\.?\d+%?)/;function V(n,t,e,r){var i,s,o;return t/=100,i=(1-G(2*(e/=100)-1))*t,t=n/60,n=P.floor(t/2),n=i*(1-G(t-2*n-1)),e=e-i/2,e=0<=t&&t<1?(s=i+e,o=n+e,0+e):1<=t&&t<2?(s=n+e,o=i+e,0+e):2<=t&&t<3?(s=0+e,o=i+e,n+e):3<=t&&t<4?(s=0+e,o=n+e,i+e):4<=t&&t<5?(s=n+e,o=0+e,i+e):(s=i+e,o=0+e,n+e),[In(P.round(255*s),0,255),In(P.round(255*o),0,255),In(P.round(255*e),0,255),r]}function A(n,t,e,r){var i=1-e/100;return e=n,n=100*i,r=r,i=(n/=100)*(1-(t=100-t/i)/200),t=P.min(i,1-i),V(e,0===t?0:100*(n-i)/t,100*i,r)}function j(n,t,e,r,i,s,o,a,u){if(9<=arguments.length){var l=1-(c=u||0);return[In(P.round(l*n+c*i),0,255),In(P.round(l*t+c*s),0,255),In(P.round(l*e+c*o),0,255),In(l*r+c*a,0,1)]}var c,l=1-(c=e||0),n=n,t=t;return 3<n.length?[In(P.round(l*n[0]+c*t[0]),0,255),In(P.round(l*n[1]+c*t[1]),0,255),In(P.round(l*n[2]+c*t[2]),0,255),In(l*n[3]+c*t[3],0,1)]:[In(P.round(l*n[0]+c*t[0]),0,255),In(P.round(l*n[1]+c*t[1]),0,255),In(P.round(l*n[2]+c*t[2]),0,255)]}var X={keywords:{transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},parse:function(n){var t,e;if(t=(n=at(ct(n)).toLowerCase()).match(h))return!(i=t[1])||i.length<3?[0,0,0,0]:i.length<6?[In(parseInt(i[0]+i[0],16)||0,0,255),In(parseInt(i[1]+i[1],16)||0,0,255),In(parseInt(i[2]+i[2],16)||0,0,255),1]:[In(parseInt(i[0]+i[1],16)||0,0,255),In(parseInt(i[2]+i[3],16)||0,0,255),In(parseInt(i[4]+i[5],16)||0,0,255),1];if(t=n.match(_)){e=t[2].match(S);var r=(u=at(t[2]).split(k).map(at))[0]?u[0]:"0",i=u[1]?u[1]:"0",s=u[2]?u[2]:"0",o=e?e[1]:"1";return A(r=parseFloat(r,10),i="%"===i.slice(-1)?parseFloat(i,10):100*parseFloat(i,10)/255,s="%"===s.slice(-1)?parseFloat(s,10):100*parseFloat(s,10)/255,o="%"===o.slice(-1)?parseFloat(o,10)/100:parseFloat(o,10))}if(t=n.match(g)){e=t[2].match(S);var r=(u=at(t[2]).split(k).map(at))[0]?u[0]:"0",n=u[1]?u[1]:"0",a=u[2]?u[2]:"0",o=e?e[1]:"hsla"===t[1]&&null!=u[3]?u[3]:"1";return V(r=parseFloat(r,10),n="%"===n.slice(-1)?parseFloat(n,10):100*parseFloat(n,10)/255,a="%"===a.slice(-1)?parseFloat(a,10):100*parseFloat(a,10)/255,o="%"===o.slice(-1)?parseFloat(o,10)/100:parseFloat(o,10))}if(t=n.match(f)){e=t[2].match(S);var u,r=(u=at(t[2]).split(k).map(at))[0]?u[0]:"0",a=u[1]?u[1]:"0",s=u[2]?u[2]:"0",o=e?e[1]:"rgba"===t[1]&&null!=u[3]?u[3]:"1";return[r="%"===r.slice(-1)?2.55*parseFloat(r,10):parseFloat(r,10),a="%"===a.slice(-1)?2.55*parseFloat(a,10):parseFloat(a,10),s="%"===s.slice(-1)?2.55*parseFloat(s,10):parseFloat(s,10),o="%"===o.slice(-1)?parseFloat(o,10)/100:parseFloat(o,10)]}return p.call(X.keywords,n)?X.keywords[n].slice():void 0},interpolateRGB:j,toCSS:function(n,t,e,r){return 1!==arguments.length?3<arguments.length?"rgba("+n+","+t+","+e+","+r+")":"rgb("+n+","+t+","+e+")":3<n.length?"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")":"rgb("+n[0]+","+n[1]+","+n[2]+")"}};n.Color=X;var u=e(null,Kn(null,{constructor:function n(t){var e=this,r=null,i=null;return t instanceof n?t:e instanceof n?(i=Kn(r=n.Properties,{},n.Defaults),dt(t)&&(i=Kn(r,i,t)),r.forEach(function(t){v(e,t,{get:function(){return i[t]},set:function(n){i[t]!==n&&(i[t]=n,e.isChanged()||(e.isChanged(!0),e.triggerChange()))},enumerable:!0,configurable:!1})}),e.toObj=function(){return r.reduce(function(n,t){return n[t]=i[t],n},{})},void e.isChanged(!0)):new n(t)},clone:function(){return new u(this.toObj())},toSVG:function(){var e=this.toObj();return Object.keys(e).reduce(function(n,t){return n+t+":"+ct(e[t])+";"},"")}},o),{Properties:["stroke-width","stroke","stroke-opacity","stroke-linecap","stroke-linejoin","fill","fill-opacity"],Defaults:{"stroke-width":1,stroke:"#000000","stroke-opacity":1,"stroke-linecap":"butt","stroke-linejoin":"miter",fill:"none","fill-opacity":1}});n.Style=u;var Y=e(null,Kn(null,{constructor:function(){var t,n,e=this,r=null;e.id=(n=e.name,ct(n||"")+"_"+ct(++lt)+"_"+ct((new Date).getTime())+"_"+ct(P.round(1e3*P.random()))),t=function(n){r===n&&(e.isChanged()||(e.isChanged(!0),e.triggerChange()))},(r=new u).onChange(t),v(e,"style",{get:function(){return r},set:function(n){n=u(n),r!==n&&(r&&r.onChange(t,!1),(r=n)&&(r.onChange(t),e.isChanged()||(e.isChanged(!0),e.triggerChange())))},enumerable:!0,configurable:!1}),e.setStyle=function(n,t){return arguments.length&&(1<arguments.length?e.style[n]=t:e.style=n),e},e.isChanged(!0)},id:"",name:"Primitive",clone:function(){return this},transform:function(){return this},setStyle:null,getBoundingBox:function(){return{ymin:-1/0,xmin:-1/0,ymax:1/0,xmax:1/0}},getConvexHull:function(){return[]},getCenter:function(){var n=this.getBoundingBox();return{x:(n.xmin+n.xmax)/2,y:(n.ymin+n.ymax)/2}},hasPoint:function(n){return!1},hasInsidePoint:function(n,t){return!1},intersects:function(n){return!1},toSVG:function(n){return arguments.length?n:""},toSVGPath:function(n){return arguments.length?n:""},toCanvas:function(n){},toTex:function(){return"\\text{Primitive}"},toString:function(){return"Primitive()"}},o)),T=e(n.Primitive=Y,{constructor:function n(t,e){var r=this,i=0,s=0,o=null;return t instanceof n?t:r instanceof n?(r.$super("constructor"),s=xt(t)?(i=ht(t[0]),ht(t[1])):dt(t)?(i=ht(t.x),ht(t.y)):(i=+t||0,+e||0),v(r,"x",{get:function(){return i},set:function(n){var t=!Bn(n=+n||0,i);i=n,t&&!r.isChanged()&&(r.isChanged(!0),r.triggerChange())},enumerable:!0,configurable:!1}),v(r,"y",{get:function(){return s},set:function(n){var t=!Bn(n=+n||0,s);s=n,t&&!r.isChanged()&&(r.isChanged(!0),r.triggerChange())},enumerable:!0,configurable:!1}),v(r,"norm",{get:function(){return null==o&&(o=Qn(i,s)),o},enumerable:!0,configurable:!1}),r.isChanged=function(n){return!0===n&&(o=null),r.$super("isChanged",arguments)},void(r.dispose=function(){s=i=null,r.$super("dispose")})):new n(t,e)},name:"Point",clone:function(){return new T(this.x,this.y)},transform:function(n){return n.transform(this)},getBoundingBox:function(){return{ymin:this.y,xmin:this.x,ymax:this.y,xmax:this.x}},eq:function(n){return n instanceof T||null!=n.x&&null!=n.y?J(this,n):!!xt(n)&&J(this,{x:n[0],y:n[1]})},add:function(n){return n instanceof T?new T(this.x+n.x,this.y+n.y):new T(this.x+(+n||0),this.y+(+n||0))},mul:function(n){return n=+n||0,new T(this.x*n,this.y*n)},dot:function(n){return Dn(this.x,this.y,n.x,n.y)},cross:function(n){return Hn(this.x,this.y,n.x,n.y)},angle:function(n){return Un(this.x,this.y,n.x,n.y)},between:function(n,t){return!!(n instanceof E?nn(this,n.start,n.end):nn(this,n,t))},distanceToLine:function(n,t){return n instanceof E?K(this,n.start,n.end):K(this,n,t)},isOn:function(n){return!!pt(n.hasPoint)&&n.hasPoint(this)},isInside:function(n,t){return!!pt(n.hasInsidePoint)&&n.hasInsidePoint(this,t)},intersects:function(n){return n instanceof T?!!this.eq(n)&&[this]:n instanceof Y&&n.intersects(this)},toObj:function(){return{x:this.x,y:this.y}},bezierPoints:function(){var n=this.x,t=this.y;return[[{x:n,y:t},{x:n,y:t},{x:n,y:t},{x:n,y:t}]]},toSVG:function(n){return Zn("circle",{id:[this.id,!1],cx:[this.x,this.isChanged()],cy:[this.y,this.isChanged()],r:[this.style["stroke-width"],this.style.isChanged()],style:["fill:"+ct(this.style.stroke)+";",this.style.isChanged()]},!!arguments.length&&n)},toSVGPath:function(n){var t=this.style["stroke-width"],t="M "+ct(this.x-t)+" "+ct(this.y)+" a "+ct(t)+" "+ct(t)+" 0 0 0 "+ct(t+t)+" 0 a "+ct(t)+" "+ct(t)+" 0 0 0 "+ct(-t-t)+" 0 z";return arguments.length?Zn("path",{id:[this.id,!1],d:[t,this.isChanged()],style:["fill:"+ct(this.style.stroke)+";",this.style.isChanged()]},n):t},toCanvas:function(n){n.beginPath(),n.fillStyle=this.style.stroke,n.arc(this.x,this.y,this.style["stroke-width"],0,$),n.fill()},toTex:function(){return"\\begin{pmatrix}"+ct(this.x)+"\\\\"+ct(this.y)+"\\end{pmatrix}"},toString:function(){return"Point("+ct(this.x)+","+ct(this.y)+")"}});n.Point=T;var z=e(Y,{constructor:function(n,t){var e,r,i,s,o,a=this,u=null,l=null,c=null,h=null,f=null,y=null,g=null;null==n&&(n=[]),null==t&&(t={}),a.$super("constructor"),i=function(n){return(n=T(n)).onChange(e),n},s=function(n){return n.onChange(e,!1),n},o=function(n,t){return n.eq(t)},(e=function(n){xt(l)&&-1!==l.indexOf(n)&&(a.isChanged()||(a.isChanged(!0),a.triggerChange()))}).id=a.id,(r=function(){a.isChanged()||(a.isChanged(!0),a.triggerChange())}).id=a.id,(l=nt(n,i,s,o)).onChange(r),f=t,u=a.hasMatrix()?x.eye():null,f.matrix=new w(0),f.matrix.isChanged(a.hasMatrix()),v(a,"matrix",{get:function(){return u||x.eye()},set:function(n){var t;a.hasMatrix()&&(t=!(n=x(n)).eq(u),u=n,t&&!a.isChanged()&&(f.matrix.isChanged(!0),a.isChanged(!0),a.triggerChange()))},enumerable:!0,configurable:!0}),a.setMatrix=function(n){return arguments.length&&(a.matrix=n),a},v(a,"_points",{get:function(){return null==c&&(c=!u||u.eq(d)?l:l.map(function(n){return u.transform(n)})),c},set:function(n){null==n&&(c=null)},enumerable:!1,configurable:!0}),v(a,"_lines",{get:function(){return null==h&&(h=function(n,t,e,r){null==t&&(t=20);null==e&&(e=.01);var i,s=[];if(r)for(s.push(n(0)),i=0;i<t;++i)!function n(t,e,r,i,s,o,a){if(i<=r||Bn(r,i))return;var u=(r+i)/2,l=o||e(r),o=a||e(i),a=e(u);K(a,l,o)<=s?t.push(o):(n(t,e,r,u,s,l,a),n(t,e,u,i,s,a,o))}(s,n,0===i?0:i/t,t===i+1?1:(i+1)/t,e);else for(i=0;i<=t;++i)s.push(n(0===i?0:t===i?1:i/t));return s}(a.f.bind(a),20,.01,!0)),h},set:function(n){null==n&&(h=null)},enumerable:!1,configurable:!0}),v(a,"points",{get:function(){return l},set:function(n){l!==n&&(xt(l)&&tt(l,s),xt(n)?((l=nt(n,i,s,o)).onChange(r),a.isChanged()||(a.isChanged(!0),a.triggerChange())):null==n&&(l=null))},enumerable:!0,configurable:!0}),v(a,"values",{get:function(){return f},set:function(n){null==n&&(f=null)},enumerable:!1,configurable:!0}),v(a,"length",{get:function(){return 0},enumerable:!0,configurable:!0}),v(a,"area",{get:function(){return 0},enumerable:!0,configurable:!0}),v(a,"_bbox",{get:function(){return{ymin:-1/0,xmin:-1/0,ymax:1/0,xmax:1/0}},enumerable:!1,configurable:!0}),v(a,"_hull",{get:function(){var n=null,n=null==y?y=a._bbox:a._bbox;return null!=g&&y===n||(g=[new T((y=n).xmin,n.ymin),new T(n.xmax,n.ymin),new T(n.xmax,n.ymax),new T(n.xmin,n.ymax)]),g},enumerable:!1,configurable:!0})},name:"Curve",dispose:function(){var t=this;t.points&&(tt(t.points,function(n){return n.onChange(t.id,!1),n}),t.points=null),t.values=null,t.$super("dispose")},isChanged:function(n){var t=this;return!1===n&&(t.points.forEach(function(n){n.isChanged(!1)}),Object.keys(t.values).forEach(function(n){t.values[n].isChanged(!1)}),t.style.isChanged(!1)),!0===n&&(t._points=null,t._lines=null),t.$super("isChanged",arguments)},isConnected:function(){return!0},isClosed:function(){return!1},isConvex:function(){return!1},hasMatrix:function(){return!0},setMatrix:null,f:function(n){return{x:0,y:0}},getPointAt:function(n){if((n=+n||0)<0||1<n)return null;n=this.f(n);return null==n?null:T(n)},getBoundingBox:function(){var n=this._bbox;return{ymin:n.ymin,xmin:n.xmin,ymax:n.ymax,xmax:n.xmax}},getConvexHull:function(){return this._hull.map(function(n){return n.clone()})},polylinePoints:function(){return this._lines.slice()},bezierPoints:function(){return[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},toTex:function(){return"\\text{Curve}"},toString:function(){return"Curve()"}}),F=e(n.Curve=z,{constructor:function(n,t){var e=this;null==n&&(n=[]),e.$super("constructor",[n,t]),v(e,"degree",{get:function(){return e.points.length-1},enumerable:!0,configurable:!1})},name:"Bezier",toTex:function(){return"\\text{"+this.name+": }\\left("+this.points.map(ft).join(",")+"\\right)"},toString:function(){return this.name+"("+this.points.map(ct).join(",")+")"}});n.Bezier=F;var q=e(z,{constructor:function(n){var t,e,r,i,s=this,o=null,a=null,u=null;null==n&&(n=[]),Y.call(s),r=function(n){return n instanceof z&&n.onChange(t),n},i=function(n){return n instanceof z&&n.onChange(t,!1),n},(t=function(n){xt(o)&&-1!==o.indexOf(n)&&(s.isChanged()||(s.isChanged(!0),s.triggerChange()))}).id=s.id,(e=function(){s.isChanged()||(s.isChanged(!0),s.triggerChange())}).id=s.id,(o=nt(n,r,i)).onChange(e),v(s,"points",{get:function(){return null==a&&(a=o.reduce(function(n,t){return n.push.apply(n,t.points),n},[])),a},set:function(n){null==n&&(a=null)},enumerable:!0,configurable:!1}),v(s,"curves",{get:function(){return o},set:function(n){o!==n&&(xt(o)&&tt(o,i),xt(n)?((o=nt(n,r,i)).onChange(e),s.isChanged()||(s.isChanged(!0),s.triggerChange())):null==n&&(o=null))},enumerable:!0,configurable:!1}),v(s,"length",{get:function(){return null==u&&(u=o.reduce(function(n,t){return n+=t.length},0)),u},enumerable:!0,configurable:!1}),v(s,"area",{get:function(){return 0},enumerable:!0,configurable:!1}),v(s,"_bbox",{get:function(){return null==_bbox&&(_bbox=o.reduce(function(n,t){t=t.getBoundingBox();return n.ymin=P.min(n.ymin,t.ymin),n.xmin=P.min(n.xmin,t.xmin),n.ymax=P.max(n.ymax,t.ymax),n.xmax=P.max(n.xmax,t.xmax),n},{ymin:1/0,xmin:1/0,ymax:-1/0,xmax:-1/0})),_bbox},enumerable:!1,configurable:!1}),v(s,"_hull",{get:function(){return null==_hull&&(_hull=$n(o.reduce(function(n,t){return n.push.apply(n,t._hull),n},[]))),_hull},enumerable:!1,configurable:!1}),s.isChanged=function(n){return!0===n&&(_area=u=a=null,_bbox=null,_hull=null),Y.prototype.isChanged.apply(s,arguments)}},name:"CompositeCurve",dispose:function(){var t=this;t.curves&&(tt(t.curves,function(n){return n instanceof z&&n.onChange(t.id,!1),n}),t.curves=null,t.points=null),Y.prototype.dispose.call(t)},clone:function(){return new q(this.curves.map(function(n){return n.clone()}))},transform:function(t){return new q(this.curves.map(function(n){return n.transform(t)}))},isConnected:function(){var n,t,e,r=this.curves,i=r.length-1;if(i<0)return!1;if(!r[0].isConnected())return!1;for(e=0;e<i;++e){if(!r[e+1].isConnected())return!1;if(n=r[e].points,t=r[e+1].points,!n[n.length-1].eq(t[0]))return!1}return!0},isClosed:function(){if(!this.isConnected())return!1;var n=this.curves;return n[0].points[0].eq(n[n.length-1].points[n[n.length-1].points.length-1])},hasPoint:function(n){for(var t=this.curves,e=t.length,r=0;r<e;++r)if(t[r].hasPoint(n))return!0;return!1},intersects:function(n){if(n instanceof T)return!!this.hasPoint(n)&&[n];if(n instanceof Y){for(var t,e=[],r=this.curves,i=r.length,s=0;s<i;++s)(t=r[s].intersects(n))&&e.push.apply(e,t);return!!e&&e.map(T)}return!1},polylinePoints:function(){return this.curves.reduce(function(n,t){return n.push.apply(n,t.polylinePoints()),n},[])},bezierPoints:function(){return this.curves.reduce(function(n,t){return n.push.apply(n,t.bezierPoints()),n},[])},toTex:function(){return"\\text{CompositeCurve: }\\begin{cases}&"+this.curves.map(ft).join("\\\\&")+"\\end{cases}"},toString:function(){return"CompositeCurve(\n"+this.curves.map(ct).join("\n")+"\n)"}});n.CompositeCurve=q;var o=e(F,{constructor:function n(t,e){var s=this,r=null,o=null;return t instanceof n?t:s instanceof n?(xt(t)&&null==e&&(e=t[1],t=t[0]),s.$super("constructor",[[t,e]]),v(s,"start",{get:function(){return s.points[0]},set:function(n){s.points[0]=n},enumerable:!0,configurable:!1}),v(s,"end",{get:function(){return s.points[1]},set:function(n){s.points[1]=n},enumerable:!0,configurable:!1}),v(s,"_lines",{get:function(){return s._points},set:function(n){},enumerable:!1,configurable:!1}),v(s,"length",{get:function(){var n;return null==r&&(n=s._points,r=H(n[0],n[1])),r},enumerable:!0,configurable:!1}),v(s,"_bbox",{get:function(){var n,t,e,r,i;return null==o&&(n=(r=s._points)[0],i=r[1],t=P.min(n.x,i.x),e=P.max(n.x,i.x),r=P.min(n.y,i.y),i=P.max(n.y,i.y),o={ymin:r,xmin:t,ymax:i,xmax:e}),o},enumerable:!1,configurable:!1}),void(s.isChanged=function(n){return!0===n&&(o=r=null),s.$super("isChanged",arguments)})):new n(t,e)},name:"Line",clone:function(){return new E(this.start.clone(),this.end.clone())},transform:function(n){return new E(this.start.transform(n),this.end.transform(n))},hasPoint:function(n){var t=this._points;return!!nn(n,t[0],t[1])},intersects:function(n){var t,e;return n instanceof T?!!(t=nn(n,(e=this._points)[0],e[1]))&&[n]:n instanceof E?!!(t=un((e=this._points)[0],e[1],n._points[0],n._points[1]))&&[T(t)]:n instanceof R?!!(t=ln((e=this._points)[0],e[1],n.center,n.radius))&&t.map(T):n instanceof N?!!(t=cn((e=this._points)[0],e[1],n.center,n.radiusX,n.radiusY,n.cs))&&t.map(T):n instanceof O?!!(t=hn((e=this._points)[0],e[1],null,n.center,n.rX,n.rY,n.cs,n.theta,n.dtheta))&&t.map(T):n instanceof B?!!(t=fn((e=this._points)[0],e[1],null,n._points))&&t.map(T):n instanceof I?!!(t=yn((e=this._points)[0],e[1],null,n._points))&&t.map(T):n instanceof Y&&n.intersects(this)},f:function(n){return Tn(n,this._points)},distanceToPoint:function(n){return Z(n,this._points[0],this._points[1])},bezierPoints:function(){var n=this._points;return[[Tn(0,n),Tn(.5,n),Tn(.5,n),Tn(1,n)]]},toSVG:function(n){var t=this._points;return Zn("line",{id:[this.id,!1],x1:[t[0].x,this.start.isChanged()||this.values.matrix.isChanged()],y1:[t[0].y,this.start.isChanged()||this.values.matrix.isChanged()],x2:[t[1].x,this.end.isChanged()||this.values.matrix.isChanged()],y2:[t[1].y,this.end.isChanged()||this.values.matrix.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},!!arguments.length&&n)},toSVGPath:function(n){var t=this._points,t="M "+ct(t[0].x)+" "+ct(t[0].y)+" L "+ct(t[1].x)+" "+ct(t[1].y);return arguments.length?Zn("path",{id:[this.id,!1],d:[t,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):t},toCanvas:function(n){var t=this._points[0],e=this._points[1];n.beginPath(),n.lineWidth=this.style["stroke-width"],n.strokeStyle=this.style.stroke,n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke()},toTex:function(){var n=this.start,t=this.end;return"\\text{Line: }"+Rn(t.y-n.y,!1)+" \\cdot x "+Rn(n.x-t.x)+" \\cdot y "+Rn(t.x*n.y-n.x*t.y)+" = 0\\text{, }"+ct(P.min(n.x,t.x))+" \\le x \\le "+ct(P.max(n.x,t.x))+"\\text{, }"+ct(P.min(n.y,t.y))+" \\le y \\le "+ct(P.max(n.y,t.y))},toString:function(){return"Line("+[ct(this.start),ct(this.end)].join(",")+")"}}),E=o;n.Bezier1=o,n.Line=E;var M=e(z,{constructor:function n(t){var i=this,e=null,r=null,s=null,o=null;return t instanceof n?t:i instanceof n?(i.$super("constructor",[t]),v(i,"lines",{get:function(){var r=i.points;return 1<r.length?r.reduce(function(n,t,e){return e+1<r.length&&(n[e]=new E(t,r[e+1])),n},new Array(r.length-1)):[]},enumerable:!0,configurable:!1}),v(i,"_lines",{get:function(){return i._points},enumerable:!1,configurable:!1}),v(i,"length",{get:function(){return null==e&&(e=Cn(i._points)),e},enumerable:!0,configurable:!1}),v(i,"_bbox",{get:function(){if(null==r){r={ymin:1/0,xmin:1/0,ymax:-1/0,xmax:-1/0};for(var n=0,t=i._points,e=t.length;n<e;++n)r.ymin=P.min(r.ymin,t[n].y),r.ymax=P.max(r.ymax,t[n].y),r.xmin=P.min(r.xmin,t[n].x),r.xmax=P.max(r.xmax,t[n].x)}return r},enumerable:!1,configurable:!1}),v(i,"_hull",{get:function(){return null==s&&(s=$n(i._points).map(T)),s},enumerable:!1,configurable:!1}),v(i,"_is_convex",{get:function(){return!!i.isClosed()&&(null==o&&(o=wn(i._points)),o)},enumerable:!1,configurable:!1}),void(i.isChanged=function(n){return!0===n&&(o=s=r=e=null),i.$super("isChanged",arguments)})):new n(t)},name:"Polyline",clone:function(){return new M(this.points.map(function(n){return n.clone()}))},transform:function(t){return new M(this.points.map(function(n){return n.transform(t)}))},isClosed:function(){return 2<this.points.length&&this.points[0].eq(this.points[this.points.length-1])},isConvex:function(){return this._is_convex},hasPoint:function(n){return function(n,t){for(var e=0,r=t.length-1;e<r;++e)if(nn(n,t[e],t[e+1]))return!0;return!1}(n,this._points)},hasInsidePoint:function(n,t){if(!this.isClosed())return!1;n=an(n,{x:this._bbox.xmax+10,y:n.y},this._points);return t?1===n:0<n},f:function(n){var t=this._points,e=t.length-1,r=P.floor(n*e);return 1===n?{x:t[e].x,y:t[e].y}:Tn(e*(n-r/e),[t[r],t[r+1]])},intersects:function(n){var t;return n instanceof T?!!this.hasPoint(n)&&[n]:n instanceof E?!!(t=gn(this._points,n._points[0],n._points[1]))&&t.map(T):n instanceof R?!!(t=xn(this._points,n.center,n.radius))&&t.map(T):n instanceof N?!!(t=dn(this._points,n.center,n.radiusX,n.radiusY,n.cs))&&t.map(T):n instanceof O?!!(t=pn(this._points,n.center,n.rX,n.rY,n.cs,n.theta,n.dtheta))&&t.map(T):n instanceof B?!!(t=mn(this._points,n._points))&&t.map(T):n instanceof I?!!(t=vn(this._points,n._points))&&t.map(T):n instanceof M?!!(t=bn(this._points,n._points))&&t.map(T):n instanceof Y&&n.intersects(this)},distanceToPoint:function(r){var i=this.points;return i.length?1===i.length?Qn(r.x-i[0].x,r.y-i[0].y):i.reduce(function(n,t,e){return e+1<i.length&&(n=P.min(n,Z(r,i[e],i[e+1]))),n},1/0):NaN},bezierPoints:function(){var r=this._points,i=r.length;return r.reduce(function(n,t,e){return e+1<i&&(e=[r[e],r[e+1]],n.push([Tn(0,e),Tn(.5,e),Tn(.5,e),Tn(1,e)])),n},[])},toSVG:function(n){return Zn("polyline",{id:[this.id,!1],points:[this._points.map(function(n){return ct(n.x)+","+ct(n.y)}).join(" "),this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},!!arguments.length&&n)},toSVGPath:function(n){var t="M "+this._points.map(function(n){return ct(n.x)+" "+ct(n.y)}).join(" L ");return arguments.length?Zn("path",{id:[this.id,!1],d:[t,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):t},toCanvas:function(n){var t=this._points,e=t.length;n.beginPath(),n.lineWidth=this.style["stroke-width"],n.fillStyle=this.style.fill,n.strokeStyle=this.style.stroke,n.moveTo(t[0].x,t[0].y);for(var r=1;r<e;++r)n.lineTo(t[r].x,t[r].y);this.isClosed()&&"none"!==this.style.fill&&n.fill(),n.stroke()},toTex:function(){return"\\text{Polyline: }\\begin{cases}&"+this.lines.map(ft).join("\\\\&")+"\\end{cases}"},toString:function(){return"Polyline("+this.points.map(ct).join(",")+")"}});n.Polyline=M;var O=e(z,{constructor:function n(t,e,r,i,s,o,a){var g=this,u=null,l=null,c=null,h=null,f=null,x=0,d=0,y=null,p=null,m=null;return t instanceof n?t:g instanceof n?(u=new w(P.abs(+r||0)),l=new w(P.abs(+i||0)),c=new w(s),x=P.cos(Wn(c.val())),d=P.sin(Wn(c.val())),h=new w(!!o),f=new w(!!a),g.$super("constructor",[[t,e],{radiusX:u,radiusY:l,angle:c,largeArc:h,sweep:f}]),v(g,"start",{get:function(){return g.points[0]},set:function(n){g.points[0]=n},enumerable:!0,configurable:!1}),v(g,"end",{get:function(){return g.points[1]},set:function(n){g.points[1]=n},enumerable:!0,configurable:!1}),v(g,"radiusX",{get:function(){return u.val()},set:function(n){u.val(P.abs(+n||0)),u.isChanged()&&!g.isChanged()&&(g.isChanged(!0),g.triggerChange())},enumerable:!0,configurable:!1}),v(g,"radiusY",{get:function(){return l.val()},set:function(n){l.val(P.abs(+n||0)),l.isChanged()&&!g.isChanged()&&(g.isChanged(!0),g.triggerChange())},enumerable:!0,configurable:!1}),v(g,"angle",{get:function(){return c.val()},set:function(n){c.val(n),x=P.cos(Wn(c.val())),d=P.sin(Wn(c.val())),c.isChanged()&&!g.isChanged()&&(g.isChanged(!0),g.triggerChange())},enumerable:!0,configurable:!1}),v(g,"largeArc",{get:function(){return h.val()},set:function(n){h.val(!!n),h.isChanged()&&!g.isChanged()&&(g.isChanged(!0),g.triggerChange())},enumerable:!0,configurable:!1}),v(g,"sweep",{get:function(){return f.val()},set:function(n){f.val(!!n),f.isChanged()&&!g.isChanged()&&(g.isChanged(!0),g.triggerChange())},enumerable:!0,configurable:!1}),v(g,"center",{get:function(){return g._params[0]},enumerable:!1,configurable:!1}),v(g,"theta",{get:function(){return g._params[1]},enumerable:!1,configurable:!1}),v(g,"dtheta",{get:function(){return g._params[2]},enumerable:!1,configurable:!1}),v(g,"rX",{get:function(){return g._params[3]},enumerable:!1,configurable:!1}),v(g,"rY",{get:function(){return g._params[4]},enumerable:!1,configurable:!1}),v(g,"cs",{get:function(){return[x,d]},enumerable:!1,configurable:!1}),v(g,"_params",{get:function(){return null==y&&(y=function(n,t,e,r,i,s,o,a,u){var l=u[0],c=u[1],h=l*(n-e)/2+c*(t-r)/2,f=-c*(n-e)/2+l*(t-r)/2,y=h*h,g=f*f,x=o*o,d=a*a,u=y/x+g/d;u=b(u);y=b(G(((x=(o*=u)*o)*(d=(a*=u)*a)-x*g-d*y)/(x*g+d*y)))*(i===s?-1:1),i=y*o*f/a,y=-y*a*h/o,e=l*i-c*y+(n+e)/2,t=c*i+l*y+(t+r)/2,r=Jn(1,0,(h-i)/o,(f-y)/a),y=Nn(Jn((h-i)/o,(f-y)/a,(-h-i)/o,(-f-y)/a))%360;!s&&0<y&&(y-=360);s&&y<0&&(y+=360);return[{x:e,y:t},r,Wn(y),o,a]}(g.start.x,g.start.y,g.end.x,g.end.y,g.largeArc,g.sweep,g.radiusX,g.radiusY,g.cs)),y},enumerable:!1,configurable:!1}),v(g,"length",{get:function(){return null==p&&(p=Cn(g._lines)),p},enumerable:!0,configurable:!1}),v(g,"_bbox",{get:function(){var n,t,e,r,i,s,o,a,u,l,c,h,f,y;return null==m&&(n=g.start,t=g.end,y=g.center,h=g.rX,a=g.rY,r=(e=g.theta)+g.dtheta,i=!1,f=P.tan(Wn(g.angle)),g.sweep||(s=e,e=r,r=s),r<e&&(s=e,e=r,r=s,i=!0),(s=P.atan2(-a*f,h))<0&&(s+=$),l=qn(s,y.x,y.y,h,a,x,d),c=qn(s+=C,y.x,y.y,h,a,x,d),(s=P.atan2(a,h*f))<0&&(s+=$),f=qn(s,y.x,y.y,h,a,x,d),h=qn(s+=C,y.x,y.y,h,a,x,d),a=c.x<l.x?(o=c,l):(o=l,c),l=f.y<h.y?(u=f,h):(u=h,f),c=Jn(1,0,o.x-y.x,o.y-y.y),h=Jn(1,0,a.x-y.x,a.y-y.y),f=Jn(1,0,u.x-y.x,u.y-y.y),y=Jn(1,0,l.x-y.x,l.y-y.y),c<0&&(c+=$),$<c&&(c-=$),h<0&&(h+=$),$<h&&(h-=$),f<0&&(f+=$),$<f&&(f-=$),y<0&&(y+=$),$<y&&(y-=$),(!i&&(c<e||r<c)||i&&!(c<e||r<c))&&(o=n.x<t.x?n:t),(!i&&(h<e||r<h)||i&&!(h<e||r<h))&&(a=n.x>t.x?n:t),(!i&&(f<e||r<f)||i&&!(f<e||r<f))&&(u=n.y<t.y?n:t),(!i&&(y<e||r<y)||i&&!(y<e||r<y))&&(l=n.y>t.y?n:t),m={ymin:u.y,xmin:o.x,ymax:l.y,xmax:a.x}),m},enumerable:!1,configurable:!1}),void(g.isChanged=function(n){return!0===n&&(m=p=y=null),g.$super("isChanged",arguments)})):new n(t,e,r,i,s,o,a)},name:"Arc",clone:function(){return new O(this.start.clone(),this.end.clone(),this.radiusX,this.radiusY,this.angle,this.largeArc,this.sweep)},transform:function(n){var t=this.radiusX,e=this.radiusY,r=this.angle,i=Nn(n.getRotationAngle()),s=n.getScale();return new O(this.start.transform(n),this.end.transform(n),t*s.x,e*s.y,r+i,this.largeArc,this.sweep)},isClosed:function(){return!1},isConvex:function(){return!1},hasMatrix:function(){return!1},f:function(n){var t=this.center,e=this.cs;return qn(this.theta+n*this.dtheta,t.x,t.y,this.rX,this.rY,e[0],e[1])},hasPoint:function(n){return tn(n,this.center,this.rX,this.rY,this.cs,this.theta,this.dtheta)},hasInsidePoint:function(n,t){return!t&&this.hasPoint(n)},intersects:function(n){var t;return n instanceof T?!!this.hasPoint(n)&&[n]:n instanceof R?!!(t=xn(this._lines,n.center,n.radius))&&t.map(T):n instanceof N?!!(t=dn(this._lines,n.center,n.radiusX,n.radiusY,n.cs))&&t.map(T):n instanceof O?!!(t=pn(this._lines,n.center,n.rX,n.rY,n.cs,n.theta,n.dtheta))&&t.map(T):n instanceof Y&&n.intersects(this)},bezierPoints:function(){var n,t,e,r=this.center,i=this.rX,s=this.rY,o=this.cs,a=o[0],u=o[1],l=this.theta,c=this.dtheta,o=2*G(c)/C;for(Bn(o,1)&&(o=1),c/=t=P.max(1,P.ceil(o)),e=new Array(t),n=0;n<t;++n,l+=c)e[n]=Mn(l,c,r.x,r.y,i,s,a,u);return e},toSVG:function(n){var t=this.toSVGPath();return Zn("path",{id:[this.id,!1],d:[t,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},!!arguments.length&&n)},toSVGPath:function(n){var t=this.start,e=this.end,r=ct(this.radiusX),i=ct(this.radiusY),s=ct(this.angle),o=ct(this.largeArc?1:0),a=ct(this.sweep?1:0),e="M "+ct(t.x)+" "+ct(t.y)+" A "+r+" "+i+" "+s+" "+o+" "+a+" "+ct(e.x)+" "+ct(e.y);return arguments.length?Zn("path",{id:[this.id,!1],d:[e,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):e},toCanvas:function(n){var t=this.center,e=this.rX,r=this.rY,i=!this.sweep,s=Wn(this.angle),o=this.theta,a=o+this.dtheta;n.beginPath(),n.lineWidth=this.style["stroke-width"],n.strokeStyle=this.style.stroke,n.ellipse(t.x,t.y,e,r,s,o,a,i),n.stroke()},toTex:function(){return"\\text{Arc: }\\left("+[ft(this.start),ft(this.end),ct(this.radiusX),ct(this.radiusY),ct(this.angle)+"\\text{°}",ct(this.largeArc?1:0),ct(this.sweep?1:0)].join(",")+"\\right)"},toString:function(){return"Arc("+[ct(this.start),ct(this.end),ct(this.radiusX),ct(this.radiusY),ct(this.angle)+"°",ct(this.largeArc),ct(this.sweep)].join(",")+")"}});n.Arc=O;var B=e(F,{constructor:function n(t){var s=this,e=null,o=null;return t instanceof n?t:s instanceof n?(s.$super("constructor",[t]),v(s,"length",{get:function(){return null==e&&(e=Cn(s._lines)),e},enumerable:!0,configurable:!1}),v(s,"_bbox",{get:function(){var n,t,e,r,i;return null==o&&(r=On(t=(i=s._points)[0].x-2*i[1].x+i[2].x,0)?i[1]:s.f((i[0].x-i[1].x)/t),n=On(e=i[0].y-2*i[1].y+i[2].y,0)?i[1]:s.f((i[0].y-i[1].y)/e),t=P.min(r.x,i[0].x,i[2].x),e=P.max(r.x,i[0].x,i[2].x),r=P.min(n.y,i[0].y,i[2].y),i=P.max(n.y,i[0].y,i[2].y),o={ymin:r,xmin:t,ymax:i,xmax:e}),o},enumerable:!1,configurable:!1}),void(s.isChanged=function(n){return!0===n&&(o=e=null),s.$super("isChanged",arguments)})):new n(t)},name:"QBezier",clone:function(){return new B(this.points.map(function(n){return n.clone()}))},transform:function(t){return new B(this.points.map(function(n){return n.transform(t)}))},hasPoint:function(n){return en(n,this._points)},intersects:function(n){var t;return n instanceof T?!!(t=en(n,this._points))&&[n]:n instanceof R?!!(t=xn(this._lines,n.center,n.radius))&&t.map(T):n instanceof N?!!(t=dn(this._lines,n.center,n.radiusX,n.radiusY,n.cs))&&t.map(T):n instanceof O?!!(t=pn(this._lines,n.center,n.rX,n.rY,n.cs,n.theta,n.dtheta))&&t.map(T):n instanceof B?!!(t=mn(this._lines,n._points))&&t.map(T):n instanceof Y&&n.intersects(this)},f:function(n){return zn(n,this._points)},bezierPoints:function(){var n=this._points;return[[{x:n[0].x,y:n[0].y},{x:n[0].x+2*(n[1].x-n[0].x)/3,y:n[0].y+2*(n[1].y-n[0].y)/3},{x:n[2].x+2*(n[1].x-n[2].x)/3,y:n[2].y+2*(n[1].y-n[2].y)/3},{x:n[2].x,y:n[2].y}]]},toSVG:function(n){return this.toSVGPath(!!arguments.length&&n)},toSVGPath:function(n){var t=this._points,t="M "+ct(t[0].x)+" "+ct(t[0].y)+" Q "+ct(t[1].x)+" "+ct(t[1].y)+","+ct(t[2].x)+" "+ct(t[2].y);return arguments.length?Zn("path",{id:[this.id,!1],d:[t,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):t},toCanvas:function(n){var t=this._points;n.beginPath(),n.lineWidth=this.style["stroke-width"],n.strokeStyle=this.style.stroke,n.moveTo(t[0].x,t[0].y),n.quadraticCurveTo(t[1].x,t[1].y,t[2].x,t[2].y),n.stroke()}});n.QBezier=n.Bezier2=B;var I=e(F,{constructor:function n(t){var s=this,e=null,o=null;return t instanceof n?t:s instanceof n?(s.$super("constructor",[t]),v(s,"length",{get:function(){return null==e&&(e=Cn(s._lines)),e},enumerable:!0,configurable:!1}),v(s,"_bbox",{get:function(){var n,t,e,r,i;return null==o&&(r=!1===(t=kn(3*(-(i=s._points)[0].x+3*i[1].x-3*i[2].x+i[3].x),2*(3*i[0].x-6*i[1].x+3*i[2].x),-3*i[0].x+3*i[1].x))?[i[1],i[2]]:t.map(function(n){return s.f(n)}),n=!1===(e=kn(3*(-i[0].y+3*i[1].y-3*i[2].y+i[3].y),2*(3*i[0].y-6*i[1].y+3*i[2].y),-3*i[0].y+3*i[1].y))?[i[1],i[2]]:e.map(function(n){return s.f(n)}),t=P.min.apply(P,r.concat([i[0],i[3]]).map(it)),e=P.max.apply(P,r.concat([i[0],i[3]]).map(it)),r=P.min.apply(P,n.concat([i[0],i[3]]).map(st)),i=P.max.apply(P,n.concat([i[0],i[3]]).map(st)),o={ymin:r,xmin:t,ymax:i,xmax:e}),o},enumerable:!1,configurable:!1}),void(s.isChanged=function(n){return!0===n&&(o=e=null),s.$super("isChanged",arguments)})):new n(t)},name:"CBezier",clone:function(){return new I(this.points.map(function(n){return n.clone()}))},transform:function(t){return new I(this.points.map(function(n){return n.transform(t)}))},hasPoint:function(n){return rn(n,this._points)},intersects:function(n){var t;return n instanceof T?!!(t=rn(n,this._points))&&[n]:n instanceof R?!!(t=xn(this._lines,n.center,n.radius))&&t.map(T):n instanceof N?!!(t=dn(this._lines,n.center,n.radiusX,n.radiusY,n.cs))&&t.map(T):n instanceof O?!!(t=pn(this._lines,n.center,n.rX,n.rY,n.cs,n.theta,n.dtheta))&&t.map(T):n instanceof B?!!(t=mn(this._lines,n._points))&&t.map(T):n instanceof I?!!(t=vn(this._lines,n._points))&&t.map(T):n instanceof Y&&n.intersects(this)},f:function(n){return Fn(n,this._points)},bezierPoints:function(){var n=this._points;return[[{x:n[0].x,y:n[0].y},{x:n[1].x,y:n[1].y},{x:n[2].x,y:n[2].y},{x:n[3].x,y:n[3].y}]]},toSVG:function(n){return this.toSVGPath(!!arguments.length&&n)},toSVGPath:function(n){var t=this._points,t="M "+ct(t[0].x)+" "+ct(t[0].y)+" C "+ct(t[1].x)+" "+ct(t[1].y)+","+ct(t[2].x)+" "+ct(t[2].y)+","+ct(t[3].x)+" "+ct(t[3].y);return arguments.length?Zn("path",{id:[this.id,!1],d:[t,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):t},toCanvas:function(n){var t=this._points;n.beginPath(),n.lineWidth=this.style["stroke-width"],n.strokeStyle=this.style.stroke,n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y),n.stroke()}});n.CBezier=n.Bezier3=I;var L=e(z,{constructor:function n(t){var r=this,e=null,i=null,s=null,o=null,a=null;return t instanceof n?t:r instanceof n?(r.$super("constructor",[t]),v(r,"vertices",{get:function(){return r.points},set:function(n){r.points=n},enumerable:!0,configurable:!1}),v(r,"edges",{get:function(){var e=r.points;return 1<e.length?e.map(function(n,t){return new E(n,e[(t+1)%e.length])}):[]},enumerable:!0,configurable:!1}),v(r,"_lines",{get:function(){return r._points.concat([r._points[0]])},enumerable:!1,configurable:!1}),v(r,"length",{get:function(){return null==e&&(e=Cn(r._lines)),e},enumerable:!0,configurable:!1}),v(r,"area",{get:function(){return null==i&&(i=function(n){for(var t,e,r=0,i=0,s=n.length-1;i<s;++i)t=n[i],e=n[i+1],r+=Hn(t.x,t.y,e.x,e.y)/2;return r}(r._lines)),i},enumerable:!0,configurable:!1}),v(r,"_bbox",{get:function(){if(null==s){s={ymin:1/0,xmin:1/0,ymax:-1/0,xmax:-1/0};for(var n=0,t=r._points,e=t.length;n<e;++n)s.ymin=P.min(s.ymin,t[n].y),s.ymax=P.max(s.ymax,t[n].y),s.xmin=P.min(s.xmin,t[n].x),s.xmax=P.max(s.xmax,t[n].x)}return s},enumerable:!1,configurable:!1}),v(r,"_hull",{get:function(){return null==o&&(o=$n(r._points).map(T)),o},enumerable:!1,configurable:!1}),v(r,"_is_convex",{get:function(){return null==a&&(a=wn(r._points)),a},enumerable:!1,configurable:!1}),void(r.isChanged=function(n){return!0===n&&(a=o=s=i=e=null),r.$super("isChanged",arguments)})):new n(t)},name:"Polygon",clone:function(){return new L(this.vertices.map(function(n){return n.clone()}))},transform:function(t){return new L(this.vertices.map(function(n){return n.transform(t)}))},isClosed:function(){return!0},isConvex:function(){return this._is_convex},hasPoint:function(n){return 2===an(n,{x:this._bbox.xmax+10,y:n.y},this._lines)},hasInsidePoint:function(n,t){n=an(n,{x:this._bbox.xmax+10,y:n.y},this._lines);return t?1===n:0<n},f:function(n){var t=this._lines,e=t.length-1,r=P.floor(n*e);return 1===n?{x:t[e].x,y:t[e].y}:Tn(e*(n-r/e),[t[r],t[r+1]])},intersects:function(n){var t;return n instanceof T?!!this.hasPoint(n)&&[n]:n instanceof E?!!(t=gn(this._lines,n._points[0],n._points[1]))&&t.map(T):n instanceof R?!!(t=xn(this._lines,n.center,n.radius))&&t.map(T):n instanceof N?!!(t=dn(this._lines,n.center,n.radiusX,n.radiusY,n.cs))&&t.map(T):n instanceof O?!!(t=pn(this._lines,n.center,n.rX,n.rY,n.cs,n.theta,n.dtheta))&&t.map(T):n instanceof B?!!(t=mn(this._lines,n._points))&&t.map(T):n instanceof I?!!(t=vn(this._lines,n._points))&&t.map(T):n instanceof M||n instanceof L?!!(t=bn(this._lines,n._lines))&&t.map(T):n instanceof Y&&n.intersects(this)},bezierPoints:function(){var r=this._lines,i=r.length;return r.reduce(function(n,t,e){return e+1<i&&(e=[r[e],r[e+1]],n.push([Tn(0,e),Tn(.5,e),Tn(.5,e),Tn(1,e)])),n},[])},toSVG:function(n){return Zn("polygon",{id:[this.id,!1],points:[this._points.map(function(n){return ct(n.x)+","+ct(n.y)}).join(" "),this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},!!arguments.length&&n)},toSVGPath:function(n){var t="M "+this._lines.map(function(n){return ct(n.x)+" "+ct(n.y)}).join(" L ")+" z";return arguments.length?Zn("path",{id:[this.id,!1],d:[t,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):t},toCanvas:function(n){var t=this._lines,e=t.length;n.beginPath(),n.lineWidth=this.style["stroke-width"],n.fillStyle=this.style.fill,n.strokeStyle=this.style.stroke,n.moveTo(t[0].x,t[0].y);for(var r=1;r<e;++r)n.lineTo(t[r].x,t[r].y);"none"!==this.style.fill&&n.fill(),n.stroke()},toTex:function(){return"\\text{Polygon: }\\left("+this.vertices.map(ft).join(",")+"\\right)"},toString:function(){return"Polygon("+this.vertices.map(ct).join(",")+")"}}),F=e(n.Polygon=L,{constructor:function n(t,e,r){var i,s,o=this;return t instanceof n?t:o instanceof n?(i=T(t),s=yt(e)&&yt(r)?new T(i.x+(+e||0),i.y+(+r||0)):T(e),o.$super("constructor",[[i,new T(s.x,i.y),s,new T(i.x,s.y)]]),v(o,"topLeft",{get:function(){return o.points[0]},set:function(n){o.points[0]=n},enumerable:!0,configurable:!1}),v(o,"bottomRight",{get:function(){return o.points[2]},set:function(n){o.points[2]=n},enumerable:!0,configurable:!1}),v(o,"width",{get:function(){return G(o.bottomRight.x-o.topLeft.x)},set:function(n){o.bottomRight.x=o.topLeft.x+(+n||0)},enumerable:!0,configurable:!1}),void v(o,"height",{get:function(){return G(o.bottomRight.y-o.topLeft.y)},set:function(n){o.bottomRight.y=o.topLeft.y+(+n||0)},enumerable:!0,configurable:!1})):new n(t,e,r)}});n.Rect=F;var R=e(z,{constructor:function n(t,e){var r=this,i=null,s=null,o=null,a=null;return t instanceof n?t:r instanceof n?(i=new w(P.abs(+e||0)),r.$super("constructor",[[t],{radius:i}]),v(r,"center",{get:function(){return r.points[0]},set:function(n){r.points[0]=n},enumerable:!0,configurable:!1}),v(r,"radius",{get:function(){return i.val()},set:function(n){i.val(P.abs(+n||0)),i.isChanged()&&!r.isChanged()&&(r.isChanged(!0),r.triggerChange())},enumerable:!0,configurable:!1}),v(r,"length",{get:function(){return null==s&&(s=$*i.val()),s},enumerable:!0,configurable:!1}),v(r,"area",{get:function(){return null==o&&(o=C*i.val()*i.val()),o},enumerable:!0,configurable:!1}),v(r,"_bbox",{get:function(){var n,t;return null==a&&(n=r.center,t=i.val(),a={ymin:n.y-t,xmin:n.x-t,ymax:n.y+t,xmax:n.x+t}),a},enumerable:!1,configurable:!1}),void(r.isChanged=function(n){return!0===n&&(a=o=s=null),r.$super("isChanged",arguments)})):new n(t,e)},name:"Circle",clone:function(){return new R(this.center.clone(),this.radius)},transform:function(n){var t=this.center,e=this.radius,r=t.transform(n),n=new T(t.x+e,t.y+e).transform(n);return new R(r,H(r,n))},isClosed:function(){return!0},isConvex:function(){return!0},hasMatrix:function(){return!1},f:function(n){var t=this.center,e=this.radius;return qn(n*$,t.x,t.y,e,e,1,0)},hasPoint:function(n){return 2===sn(n,this.center,this.radius)},hasInsidePoint:function(n,t){n=sn(n,this.center,this.radius);return t?1===n:0<n},intersects:function(n){if(n instanceof T)return!!this.hasPoint(n)&&[n];if(n instanceof R){var t=function(n,t,e,r){{t<r&&(s=t,t=r,r=s,s=n,n=e,e=s)}var i=e.x-n.x,s=e.y-n.y,e=Qn(i,s);if(Bn(e,0)&&Bn(t,r))return!1;if(t+r<e||e+r<t)return!1;i/=e,s/=e;r=(t*t-r*r+e*e)/(2*e),e=n.x+r*i,n=n.y+r*s,r=b(t*t-r*r);return On(r,0)?[{x:e,y:n}]:[{x:e+r*s,y:n-r*i},{x:e-r*s,y:n+r*i}]}(this.center,this.radius,n.center,n.radius);return!!t&&t.map(T)}return n instanceof Y&&n.intersects(this)},bezierPoints:function(){var n=this.center,t=this.radius;return[Mn(0,-C/2,n.x,n.y,t,t,1,0),Mn(-C/2,-C/2,n.x,n.y,t,t,1,0),Mn(-C,-C/2,n.x,n.y,t,t,1,0),Mn(-3*C/2,-C/2,n.x,n.y,t,t,1,0)]},toSVG:function(n){var t=this.center,e=this.radius;return Zn("circle",{id:[this.id,!1],cx:[t.x,this.center.isChanged()],cy:[t.y,this.center.isChanged()],r:[e,this.values.radius.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},!!arguments.length&&n)},toSVGPath:function(n){var t=this.center,e=this.radius,e="M "+ct(t.x-e)+" "+ct(t.y)+" a "+ct(e)+" "+ct(e)+" 0 0 0 "+ct(e+e)+" 0 a "+ct(e)+" "+ct(e)+" 0 0 0 "+ct(-e-e)+" 0 z";return arguments.length?Zn("path",{id:[this.id,!1],d:[e,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):e},toCanvas:function(n){var t=this.center,e=this.radius;n.beginPath(),n.lineWidth=this.style["stroke-width"],n.fillStyle=this.style.fill,n.strokeStyle=this.style.stroke,n.arc(t.x,t.x,e,0,$),"none"!==this.style.fill&&n.fill(),n.stroke()},toTex:function(){var n=this.center,t=ct(this.radius);return"\\text{Circle: }\\left|\\begin{pmatrix}\\frac{x"+Rn(-n.x)+"}{"+t+"}\\\\\\frac{y"+Rn(-n.y)+"}{"+t+"}\\end{pmatrix}\\right|^2 = 1"},toString:function(){return"Circle("+[ct(this.center),ct(this.radius)].join(",")+")"}});n.Circle=R;var N=e(z,{constructor:function n(t,e,r,i){var a=this,u=null,l=null,s=null,c=0,h=0,o=null,f=null,y=null,g=null;return t instanceof n?t:a instanceof n?(u=new w(P.abs(+e||0)),l=new w(P.abs(+r||0)),s=new w(i),c=P.cos(Wn(s.val())),h=P.sin(Wn(s.val())),a.$super("constructor",[[t],{radiusX:u,radiusY:l,angle:s}]),v(a,"center",{get:function(){return a.points[0]},set:function(n){a.points[0]=n},enumerable:!0,configurable:!1}),v(a,"radiusX",{get:function(){return u.val()},set:function(n){u.val(P.abs(+n||0)),u.isChanged()&&!a.isChanged()&&(a.isChanged(!0),a.triggerChange())},enumerable:!0,configurable:!1}),v(a,"radiusY",{get:function(){return l.val()},set:function(n){l.val(P.abs(+n||0)),l.isChanged()&&!a.isChanged()&&(a.isChanged(!0),a.triggerChange())},enumerable:!0,configurable:!1}),v(a,"angle",{get:function(){return s.val()},set:function(n){s.val(n),c=P.cos(Wn(s.val())),h=P.sin(Wn(s.val())),s.isChanged()&&!a.isChanged()&&(a.isChanged(!0),a.triggerChange())},enumerable:!0,configurable:!1}),v(a,"cs",{get:function(){return[c,h]},enumerable:!1,configurable:!1}),v(a,"length",{get:function(){return null==o&&(o=C*(3*(u.val()+l.val())-b((3*u.val()+l.val())*(u.val()+3*l.val())))),o},enumerable:!0,configurable:!1}),v(a,"area",{get:function(){return null==f&&(f=C*u.val()*l.val()),f},enumerable:!0,configurable:!1}),v(a,"_bbox",{get:function(){var n,t,e,r,i,s,o;return null==y&&(n=a.center,t=u.val(),o=l.val(),s=P.tan(Wn(a.angle)),r=qn(e=P.atan2(-o*s,t),n.x,n.y,t,o,c,h),i=qn(e+C,n.x,n.y,t,o,c,h),s=qn(e=P.atan2(o,t*s),n.x,n.y,t,o,c,h),o=qn(e+C,n.x,n.y,t,o,c,h),y={ymin:P.min(s.y,o.y),xmin:P.min(r.x,i.x),ymax:P.max(s.y,o.y),xmax:P.max(r.x,i.x)}),y},enumerable:!1,configurable:!1}),v(a,"_hull",{get:function(){var n,t,e;return null==g&&(n=a.center,t=u.val(),e=l.val(),g=[new T(En(-1,-1,n.x,n.y,t,e,c,h)),new T(En(1,-1,n.x,n.y,t,e,c,h)),new T(En(1,1,n.x,n.y,t,e,c,h)),new T(En(-1,1,n.x,n.y,t,e,c,h))]),g},enumerable:!1,configurable:!1}),void(a.isChanged=function(n){return!0===n&&(g=y=f=o=null),a.$super("isChanged",arguments)})):new n(t,e,r,i)},name:"Ellipse",clone:function(){return new N(this.center.clone(),this.radiusX,this.radiusY,this.angle)},transform:function(n){var t=this.center,e=this.radiusX,r=this.radiusY,i=this.angle,s=n.getTranslation(),o=Nn(n.getRotationAngle()),n=n.getScale();return new N(new T(t.x+s.x,t.y+s.y),e*n.x,r*n.y,i+o)},isClosed:function(){return!0},isConvex:function(){return!0},hasMatrix:function(){return!1},f:function(n){var t=this.center,e=this.cs;return qn(n*$,t.x,t.y,this.radiusX,this.radiusY,e[0],e[1])},hasPoint:function(n){return 2===on(n,this.center,this.radiusX,this.radiusY,this.cs)},hasInsidePoint:function(n,t){n=on(n,this.center,this.radiusX,this.radiusY,this.cs);return t?1===n:0<n},intersects:function(n){var t;return n instanceof T?!!this.hasPoint(n)&&[n]:n instanceof R?!!(t=xn(this._lines,n.center,n.radius))&&t.map(T):n instanceof N?!!(t=dn(this._lines,n.center,n.radiusX,n.radiusY,n.cs))&&t.map(T):n instanceof Y&&n.intersects(this)},bezierPoints:function(){var n=this.center,t=this.cs,e=t[0],r=t[1],i=this.radiusX,t=this.radiusY;return[Mn(0,-C/2,n.x,n.y,i,t,e,r),Mn(-C/2,-C/2,n.x,n.y,i,t,e,r),Mn(-C,-C/2,n.x,n.y,i,t,e,r),Mn(-3*C/2,-C/2,n.x,n.y,i,t,e,r)]},toSVG:function(n){var t=this.center,e=this.radiusX,r=this.radiusY,i=this.angle;return Zn("ellipse",{id:[this.id,!1],cx:[t.x,this.center.isChanged()],cy:[t.y,this.center.isChanged()],rx:[e,this.values.radiusX.isChanged()],ry:[r,this.values.radiusY.isChanged()],transform:["rotate("+ct(i)+" "+ct(t.x)+" "+ct(t.y)+")",this.center.isChanged()||this.values.angle.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},!!arguments.length&&n)},toSVGPath:function(n){this.center;var t=this.radiusX,e=this.radiusY,r=this.angle,i=this.f(0),s=this.f(.5),i="M "+ct(i.x)+" "+ct(i.y)+" A "+ct(t)+" "+ct(e)+" "+ct(r)+" 0 1 "+ct(s.x)+" "+ct(s.y)+" A "+ct(t)+" "+ct(e)+" "+ct(r)+" 0 1 "+ct(i.x)+" "+ct(i.y)+" z";return arguments.length?Zn("path",{id:[this.id,!1],d:[i,this.isChanged()],style:[this.style.toSVG(),this.style.isChanged()]},n):i},toCanvas:function(n){var t=this.center,e=this.radiusX,r=this.radiusY,i=Wn(this.angle);n.beginPath(),n.lineWidth=this.style["stroke-width"],n.fillStyle=this.style.fill,n.strokeStyle=this.style.stroke,n.ellipse(t.x,t.x,e,r,i,0,$),"none"!==this.style.fill&&n.fill(),n.stroke()},toTex:function(){var n=ct(this.angle)+"\\text{°}",t=this.center,e=ct(this.radiusX),r=ct(this.radiusY);return"\\text{Ellipse: }\\left|\\begin{pmatrix}\\cos("+n+")&-\\sin("+n+")\\\\sin("+n+")&\\cos("+n+")\\end{pmatrix}\\begin{pmatrix}\\frac{x"+Rn(-t.x)+"}{"+e+"}\\\\\\frac{y"+Rn(-t.y)+"}{"+r+"}\\end{pmatrix}\\right|^2 = 1"},toString:function(){return"Ellipse("+[ct(this.center),ct(this.radiusX),ct(this.radiusY),ct(this.angle)+"°"].join(",")+")"}});n.Ellipse=N;F=e(Y,{});n.Shape=F;F={linear:function(n){return n},"ease-in-quad":function(n){return n*n},"ease-out-quad":function(n){n=1-n;return 1-n*n},"ease-in-out-quad":function(n){return n<.5?2*n*n:1-P.pow(2-2*n,2)/2},"ease-in-cubic":function(n){return n*n*n},"ease-out-cubic":function(n){return 1-P.pow(1-n,3)},"ease-in-out-cubic":function(n){return n<.5?4*n*n*n:1-P.pow(2-2*n,3)/2},"cubic-bezier":function(n,t,e,r){return u=(n=[n,t,e,r]).length-1,t=n[0]||0,e=(0<u?n[1]:t)||0,r=(1<u?n[2]:e)||0,n=(2<u?n[3]:r)||0,function(i,s,o,a){return 3<=u?function(n){var t=1-n,e=n*n,r=t*t;return t*r*i+3*r*n*s+3*t*e*o+e*n*a}:2==u?function(n){var t=1-n;return t*t*i+2*t*n*s+n*n*o}:1==u?function(n){return(1-n)*i+n*s}:function(n){return i}}(t,e,r,n);var u},"ease-in-expo":function(n){return 0===n?0:P.pow(2,10*n-10)},"ease-out-expo":function(n){return 1===n?1:1-P.pow(2,-10*n)},"ease-in-out-expo":function(n){return 0===n?0:1===n?1:n<.5?P.pow(2,20*n-10)/2:(2-P.pow(2,10-20*n))/2},"ease-in-back":function(n){return 2.70158*n*n*n-1.70158*n*n},"ease-out-back":function(n){--n;return 1+2.70158*P.pow(n,3)+1.70158*P.pow(n,2)},"ease-in-out-back":function(n){var t=2.5949095;return n<.5?P.pow(2*n,2)*(7.189819*n-t)/2:(P.pow(2*n-2,2)*((1+t)*(2*n-2)+t)+2)/2},"ease-in-elastic":function(n){return 0===n?0:1===n?1:-P.pow(2,10*n-10)*P.sin((10*n-10.75)*$/3)},"ease-out-elastic":function(n){return 0===n?0:1===n?1:P.pow(2,-10*n)*P.sin((10*n-.75)*$/3)+1},"ease-in-out-elastic":function(n){return 0===n?0:1===n?1:n<.5?-(P.pow(2,20*n-10)*P.sin((20*n-11.125)*$/4.5))/2:P.pow(2,-20*n+10)*P.sin((20*n-11.125)*$/4.5)/2+1},"ease-in-bounce":function(n){return 1-W(1-n)},"ease-out-bounce":W,"ease-in-out-bounce":function(n){return n<.5?(1-W(1-2*n))/2:(1+W(2*n-1))/2}};function W(n){var t,e=7.5625,r=2.75;return n<1/r?e*n*n:n<2/r?(t=n-1.5)/r*e*t+.75:n<2.5/r?(t=n-2.25)/r*e*t+.9375:(t=n-2.625)/r*e*t+.984375}function Q(n){return n.reverse?n.current.frame<0:n.current.frame>=n.nframes}F["ease-in"]=F["ease-in-quad"],F["ease-out"]=F["ease-out-quad"],F["ease-in-out"]=F["ease-in-out-quad"];var D=e(Y,{constructor:function n(e){var t,r=this,i=!1,s=0,o=null,a=null;return e instanceof n?e:r instanceof n?(Y.call(r),r.start=function(){var n;return i=!0,((n=e).reverse?n.nframes-1===n.current.frame:0===n.current.frame)&&o&&o(r),setTimeout(t,(e.delay||0)+s),r},r.stop=function(){return i=!1,r},r.rewind=function(){return function(n){n.reverse?n.kf=n.keyframes.length-1:n.kf=0;var t,e,r,i,s,o,a=n.keyframes[n.kf],u=a.transform.translate.x,l=a.transform.translate.y,c=a.transform.scale.origin.x,h=a.transform.scale.origin.y,f=a.transform.scale.x,y=a.transform.scale.y,g=a.transform.rotate.origin.x,x=a.transform.rotate.origin.y,d=a.transform.rotate.angle,p=1,m=0,v=a.shape,b=v.length,C=new Array(b);for(Bn(d,0)||(p=P.cos(d),m=P.sin(d)),e=0;e<b;++e){for(t=v[e],o=new Array(4),r=0;r<4;++r)i=f*((s=t[r]).x-c)+c,s=y*(s.y-h)+h,o[r]={x:p*i-m*s+g-p*g+m*x+u,y:m*i+p*s+x-p*x-m*g+l};C[e]=o}n.current={frame:n.reverse?n.nframes-1:0,shape:C,transform:a.transform,style:a.style}}(e),r.isChanged(!0),r},r.reverse=function(n){return e.reverse=!!n,r},r.onStart=function(n){return o=pt(n)?n:null,r},r.onEnd=function(n){return a=pt(n)?n:null,r},r.toSVGPath=function(n){var t=e.current.shape.map(function(n){return"M "+n[0].x+" "+n[0].y+" C "+n[1].x+" "+n[1].y+","+n[2].x+" "+n[2].y+","+n[3].x+" "+n[3].y}).join(" ");return arguments.length&&(e.current.style.stroke&&(r.style.stroke=e.current.style.hasStroke?X.toCSS(e.current.style.stroke):e.current.style.stroke,r.style["stroke-opacity"]=e.current.style["stroke-opacity"]),e.current.style.fill&&(r.style.fill=e.current.style.hasFill?X.toCSS(e.current.style.fill):e.current.style.fill,r.style["fill-opacity"]=e.current.style["fill-opacity"])),arguments.length?Zn("path",{id:[r.id,!1],d:[t,r.isChanged()],style:[r.style.toSVG(),r.style.isChanged()]},n):t},r.toSVG=function(n){return r.toSVGPath(!!arguments.length&&n)},r.toCanvas=function(t){t.beginPath(),t.lineWidth=this.style["stroke-width"],t.strokeStyle=e.current.style.hasStroke?X.toCSS(e.current.style.stroke.concat([e.current.style["stroke-opacity"]])):e.current.style.stroke||this.style.stroke,e.current.style.fill&&(t.fillStyle=e.current.style.hasFill?X.toCSS(e.current.style.fill.concat([e.current.style["fill-opacity"]])):e.current.style.fill),e.current.shape.forEach(function(n){t.moveTo(n[0].x,n[0].y),t.bezierCurveTo(n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y)}),e.current.style.fill&&t.fill(),t.stroke()},r.dispose=function(){i=!1,e=a=o=null,r.$super("dispose")},s=P.floor(1e3/60),e=function(f,n){(f=f||{}).keyframes||(f.keyframes={"0%":f.from,"100%":f.to});var y={duration:null==f.duration?1e3:f.duration||0,delay:f.delay||0,fps:n,nframes:0,keyframes:null,kf:0,current:null,reverse:!1},g={},x=-1/0,d=pt(f.easing)?f.easing:gt(f.easing)&&p.call(D.Easing,f.easing)?D.Easing[f.easing]:D.Easing.linear;return y.nframes=P.ceil(y.duration/1e3*y.fps),y.keyframes=Object.keys(f.keyframes||m).map(function(n){var t=f.keyframes[n]||m,e=t.shape&&pt(t.shape.bezierPoints)?g[t.shape.id]||t.shape.bezierPoints():[],r=t.transform||m,i=r.scale||m,s=i.origin||{x:0,y:0},o=r.rotate||m,a=o.origin||{x:0,y:0},u=r.translate||m,l=t.style||m,c=gt(l.stroke)?X.parse(l.stroke)||l.stroke:null,h=gt(l.fill)?X.parse(l.fill)||l.fill:null,r=xt(c),l=xt(h);return t.shape&&t.shape.id&&null==g[t.shape.id]&&(g[t.shape.id]=e),x=P.max(x,e.length),{frame:P.round((parseFloat(n,10)||0)/100*(y.nframes-1)),shape:e,transform:{scale:{origin:{x:s.x||0,y:s.y||0},x:(null==i.x?1:i.x)||0,y:(null==i.y?1:i.y)||0},rotate:{origin:{x:a.x||0,y:a.y||0},angle:Wn(o.angle||0)},translate:{x:u.x||0,y:u.y||0}},style:{stroke:r?c.slice(0,3):c,"stroke-opacity":r?c[3]:1,fill:l?h.slice(0,3):h,"fill-opacity":l?h[3]:1,hasStroke:r,hasFill:l},easing:pt(t.easing)?t.easing:gt(t.easing)&&p.call(D.Easing,t.easing)?D.Easing[t.easing]:d}}).sort(function(n,t){return n.frame-t.frame}),y.keyframes.forEach(function(n){!function(n,t){if(n.length<t){var e=n.length?1:0,r={x:0,y:0};for(t-=n.length;0<t;)1<=e&&(r=n[e-1][3]),n.splice(e,0,[{x:r.x,y:r.y},{x:r.x,y:r.y},{x:r.x,y:r.y},{x:r.x,y:r.y}]),--t,e+=n.length>e+1?2:1}}(n.shape,x)}),y}(e,60),t=function n(){i&&e&&(!function(n){if(n.current.frame+=n.reverse?-1:1,!Q(n)){var t,e;b=n.reverse?(n.current.frame<=n.keyframes[n.kf-1].frame&&0<=n.kf-2&&--n.kf,t=n.keyframes[n.kf],e=n.keyframes[n.kf-1],G(n.current.frame-t.frame)/(t.frame-e.frame+1)):(n.current.frame>=n.keyframes[n.kf+1].frame&&n.kf+2<n.keyframes.length&&++n.kf,t=n.keyframes[n.kf],e=n.keyframes[n.kf+1],(n.current.frame-t.frame)/(e.frame-t.frame+1));var r,i,s,o,a,u,l,c,h=t.easing(b),f=Yn(t.transform.translate.x,e.transform.translate.x,h),y=Yn(t.transform.translate.y,e.transform.translate.y,h),g=Yn(t.transform.scale.origin.x,e.transform.scale.origin.x,h),x=Yn(t.transform.scale.origin.y,e.transform.scale.origin.y,h),d=Yn(t.transform.scale.x,e.transform.scale.x,h),p=Yn(t.transform.scale.y,e.transform.scale.y,h),m=Yn(t.transform.rotate.origin.x,e.transform.rotate.origin.x,h),v=Yn(t.transform.rotate.origin.y,e.transform.rotate.origin.y,h),b=Yn(t.transform.rotate.angle,e.transform.rotate.angle,h),C=1,$=0,w=t.shape,_=e.shape,k=w.length,S=new Array(k);for(Bn(b,0)||(C=P.cos(b),$=P.sin(b)),o=0;o<k;++o){for(r=w[o],i=_[o],c=new Array(4),a=0;a<4;++a)l=r[a],s=i[a],u=d*(l.x+h*(s.x-l.x)-g)+g,l=p*(l.y+h*(s.y-l.y)-x)+x,c[a]={x:C*u-$*l+m-C*m+$*v+f,y:$*u+C*l+v-C*v-$*m+y};S[o]=c}return n.current.shape=S,n.current.style={stroke:t.style.hasStroke&&e.style.hasStroke?j(t.style.stroke,e.style.stroke,h):e.style.stroke?e.style.stroke:t.style.stroke||n.current.style.stroke,"stroke-opacity":Yn(t.style["stroke-opacity"],e.style["stroke-opacity"],h),fill:t.style.hasFill&&e.style.hasFill?j(t.style.fill,e.style.fill,h):e.style.fill?e.style.fill:t.style.fill||n.current.style.fill,"fill-opacity":Yn(t.style["fill-opacity"],e.style["fill-opacity"],h),hasStroke:t.style.hasStroke&&e.style.hasStroke,hasFill:t.style.hasFill&&e.style.hasFill}}}(e)||(r.isChanged(!0),Q(e)?a&&setTimeout(function(){a(r)},s):setTimeout(n,s)))},void r.rewind()):new n(e)},name:"Tween",rewind:null,start:null,stop:null,onStart:null,onEnd:null},{Easing:F});n.Tween=D;F=e(null,{constructor:function n(t,e,r){var i,s,o,a=this,u=null,l=null,c=null,h=null,f=!0;if(!(a instanceof n))return new n(t,e,r);e=P.abs(+e||0),r=P.abs(+r||0),c=[],v(a,"width",{get:function(){return e},set:function(n){n=P.abs(+n||0),e!==n&&(f=!0),e=n},enumerable:!0,configurable:!(l={})}),v(a,"height",{get:function(){return r},set:function(n){n=P.abs(+n||0),r!==n&&(f=!0),r=n},enumerable:!0,configurable:!1}),a.add=function(n){return n instanceof Y&&(p.call(l,n.id)||(l[n.id]=null,c.push(n),f=!0)),a},a.remove=function(n){var t,e=c.indexOf(n);return-1!==e&&(t=l[n.id],y&&t&&t.parentNode&&t.parentNode.removeChild(t),delete l[n.id],c.splice(e,1),f=!0),a},a.getIntersections=function(){if(!c||!c.length)return[];if(f||!h){h=[];for(var n,t,e=0,r=c.length;e<r;++e)for(n=e+1;n<r;++n)(t=c[e].intersects(c[n]))&&h.push.apply(h,t)}return h?h.map(function(n){return n.clone()}):[]},a.dispose=function(){return y&&u&&u.parentNode&&u.parentNode.removeChild(u),y&&window.cancelAnimationFrame(o),c=l=u=null,a},a.toSVG=function(){return Zn("svg",{xmlns:["http://www.w3.org/2000/svg",!0],viewBox:["0 0 "+ct(e)+" "+ct(r),!0]},!1,c.map(function(n){return n instanceof Y?n.toSVG():""}).join(""))},a.toCanvas=function(n){return y?s(n||document.createElement("canvas")):n},a.toIMG=function(){return y?a.toCanvas(document.createElement("canvas")).toDataURL("image/png"):""},i=function n(){c&&(u?f&&Zn("svg",{viewBox:["0 0 "+ct(e)+" "+ct(r),f]},u):(u=Zn("svg",{xmlns:["http://www.w3.org/2000/svg",!1],style:["position:absolute;width:100%;height:100%",!1],viewBox:["0 0 "+ct(e)+" "+ct(r),f]},null),t.appendChild(u)),c.forEach(function(n){var t;n instanceof Y&&(null===(t=l[n.id])?(l[n.id]=t=n.toSVG(null),t&&u.appendChild(t)):t&&n.isChanged()&&n.toSVG(t),n.isChanged(!1))}),f=!1,o=window.requestAnimationFrame(n))},s=function(n){var t;return c&&n&&(n.style.width=ct(e)+"px",n.style.height=ct(r)+"px",n.setAttribute("width",ct(e)+"px"),n.setAttribute("height",ct(r)+"px"),(t=n.getContext("2d")).fillStyle="transparent",t.fillRect(0,0,e,r),c.forEach(function(n){n instanceof Y&&n.toCanvas(t)})),n},y&&(o=window.requestAnimationFrame(i))},dispose:null,add:null,remove:null,getIntersections:null,toSVG:null,toCanvas:null,toIMG:null});function H(n,t){return Qn(n.x-t.x,n.y-t.y)}function U(n,t,e){var r=n.x-e.x,i=t.x-e.x,n=n.y-e.y;return r*(t.y-e.y)-n*i}function J(n,t){return Bn(n.x,t.x)&&Bn(n.y,t.y)}function K(n,t,e){var r=t.x,i=t.y,s=e.x,o=e.y,t=n.x,e=n.y,n=s-r,s=o-i,o=Qn(n,s);return On(o,0)?Qn(t-r,e-i):G(n*(i-e)-s*(r-t))/o}function Z(n,t,e){var r=t.x,i=t.y,s=e.x,o=e.y,a=n.x,t=n.y,e=0,n=s-r,s=o-i,o=Qn(n,s);return On(o,0)?Qn(a-r,t-i):(e=P.max(0,P.min(1,((a-r)*n+(t-i)*s)/o)),Qn(a-r-e*n,t-i-e*s))}function nn(n,t,e){var r,i=n.x-t.x,s=e.x-t.x,n=n.y-t.y,t=e.y-t.y;return!!Bn(n*s,t*i)&&(0<=(r=On(s,0)?n/t:i/s)&&r<=1)}function tn(n,t,e,r,i,s,o){var a=n.x-t.x,n=n.y-t.y,t=i[0]*a+i[1]*n,n=-i[1]*a+i[0]*n,e=P.atan2(n/r,t/e);return e<0&&(e+=$),0<=(e=(e-s)/o)&&e<=1}function en(n,t){var e=kn(t[0].x-2*t[1].x+t[2].x,-2*t[0].x+2*t[1].x,t[0].x-n.x);return!!e&&(1<e.length&&(e[1]<0||1<e[1])&&e.pop(),e.length&&(e[0]<0||1<e[0])&&e.shift(),!!e.length&&(!!(n=kn(t[0].y-2*t[1].y+t[2].y,-2*t[0].y+2*t[1].y,t[0].y-n.y))&&(1<n.length&&(n[1]<0||1<n[1])&&n.pop(),n.length&&(n[0]<0||1<n[0])&&n.shift(),!!n.length&&(1<e.length&&1<n.length?Bn(e[0],n[0])&&Bn(e[1],n[1])||Bn(e[0],n[1])&&Bn(e[1],n[0]):1<e.length&&1===n.length?Bn(e[0],n[0])||Bn(e[1],n[0]):1<n.length&&1===e.length?Bn(n[0],e[0])||Bn(n[1],e[0]):Bn(e[0],n[0])))))}function rn(n,t){var e=Sn(-t[0].x+3*t[1].x-3*t[2].x+t[3].x,3*t[0].x-6*t[1].x+3*t[2].x,-3*t[0].x+3*t[1].x,t[0].x-n.x);return!!e&&(2<e.length&&(e[2]<0||1<e[2])&&e.pop(),1<e.length&&(e[1]<0||1<e[1])&&e.splice(1,1),e.length&&(e[0]<0||1<e[0])&&e.shift(),!!e.length&&(!!(n=Sn(-t[0].y+3*t[1].y-3*t[2].y+t[3].y,3*t[0].y-6*t[1].y+3*t[2].y,-3*t[0].y+3*t[1].y,t[0].y-n.y))&&(2<n.length&&(n[2]<0||1<n[2])&&n.pop(),1<n.length&&(n[1]<0||1<n[1])&&n.splice(1,1),n.length&&(n[0]<0||1<n[0])&&n.shift(),!!n.length&&(2<e.length&&2<n.length?Bn(e[0],n[0])&&(Bn(e[1],n[1])&&Bn(e[2],n[2])||Bn(e[1],n[2])&&Bn(e[2],n[1]))||Bn(e[1],n[1])&&Bn(e[0],n[2])&&Bn(e[2],n[0])||Bn(e[2],n[2])&&Bn(e[0],n[1])&&Bn(e[1],n[0])||Bn(e[0],n[1])&&Bn(e[1],n[2])&&Bn(e[2],n[0])||Bn(e[0],n[2])&&Bn(e[1],n[0])&&Bn(e[2],n[1]):2<e.length&&1<n.length?Bn(e[0],n[0])&&(Bn(e[1],n[1])||Bn(e[2],n[1]))||Bn(e[1],n[1])&&(Bn(e[0],n[0])||Bn(e[2],n[0]))||Bn(e[2],n[0])&&(Bn(e[1],n[1])||Bn(e[0],n[1]))||Bn(e[1],n[0])&&(Bn(e[2],n[1])||Bn(e[0],n[1])):1<e.length&&2<n.length?Bn(n[0],e[0])&&(Bn(n[1],e[1])||Bn(n[2],e[1]))||Bn(n[1],e[1])&&(Bn(n[0],e[0])||Bn(n[2],e[0]))||Bn(n[2],e[0])&&(Bn(n[1],e[1])||Bn(n[0],e[1]))||Bn(n[1],e[0])&&(Bn(n[2],e[1])||Bn(n[0],e[1])):2<e.length&&1===n.length?Bn(e[0],n[0])||Bn(e[1],n[0])||Bn(e[2],n[0]):2<n.length&&1===e.length?Bn(n[0],e[0])||Bn(n[1],e[0])||Bn(n[2],e[0]):1<e.length&&1===n.length?Bn(e[0],n[0])||Bn(e[1],n[0]):1<n.length&&1===e.length?Bn(n[0],e[0])||Bn(n[1],e[0]):Bn(e[0],n[0])))))}function sn(n,t,e){var r=n.x-t.x,t=n.y-t.y,t=r*r+t*t,e=e*e;return Bn(t,e)?2:t<e?1:0}function on(n,t,e,r,i){var s=e*e,o=r*r,e=i[0],r=i[1],i=n.x-t.x,n=n.y-t.y,t=e*i-r*n,i=e*n+r*i,o=t*t/s+i*i/o;return Bn(o,1)?2:o<1?1:0}function an(n,t,e){for(var r,i,s=0,o=0,a=e.length-1;s<a;++s){if(nn(n,r=e[s],i=e[s+1]))return 2;un(n,t,r,i)&&++o}return 1&o?1:0}function un(n,t,e,r){var i=Pn(t.y-n.y,n.x-t.x,t.x*n.y-n.x*t.y,r.y-e.y,e.x-r.x,r.x*e.y-e.x*r.y);return!!(i&&nn(i,n,t)&&nn(i,e,r))&&i}function ln(n,t,e,r){3<arguments.length&&(e=Vn(e,r));var i,s,o=new Array(2),a=0,u=Gn(t.y-n.y,n.x-t.x,t.x*n.y-n.x*t.y,e[0],e[1],e[2],e[3],e[4],e[5]);if(!u)return!1;for(i=0,s=u.length;i<s;++i)nn(u[i],n,t)&&(o[a++]=u[i]);return o.length=a,!!o.length&&o}function cn(n,t,e,r,i,s){5<arguments.length&&(e=An(e,r,i,s));var o,a,u=new Array(2),l=0,c=Gn(t.y-n.y,n.x-t.x,t.x*n.y-n.x*t.y,e[0],e[1],e[2],e[3],e[4],e[5]);if(!c)return!1;for(o=0,a=c.length;o<a;++o)nn(c[o],n,t)&&(u[l++]=c[o]);return u.length=l,!!u.length&&u}function hn(n,t,e,r,i,s,o,a,u){null==e&&(e=An(r,i,s,o));var l,c,h=new Array(2),f=0,y=Gn(t.y-n.y,n.x-t.x,t.x*n.y-n.x*t.y,e[0],e[1],e[2],e[3],e[4],e[5]);if(!y)return!1;for(l=0,c=y.length;l<c;++l)nn(y[l],n,t)&&tn(y[l],r,i,s,o,a,u)&&(h[f++]=y[l]);return h.length=f,!!h.length&&h}function fn(n,t,e,r){null==e&&(e=jn(r));var i,s,o=new Array(2),a=0,u=Gn(t.y-n.y,n.x-t.x,t.x*n.y-n.x*t.y,e[0],e[1],e[2],e[3],e[4],e[5]);if(!u)return!1;for(i=0,s=u.length;i<s;++i)nn(u[i],n,t)&&en(u[i],r)&&(o[a++]=u[i]);return o.length=a,!!o.length&&o}function yn(n,t,e,r){null==e&&(e=Xn(r));for(var i,s=new Array(3),o=0,a=t.y-n.y,u=n.x-t.x,l=n.x*(n.y-t.y)+n.y*(t.x-n.x),c=Sn(a*e[0].x+u*e[0].y,a*e[1].x+u*e[1].y,a*e[2].x+u*e[2].y,a*e[3].x+u*e[3].y+l),h=0,f=c.length;h<f;++h)c[h]<0||1<c[h]||nn(i=Fn(c[h],r),n,t)&&(s[o++]=i);return s.length=o,!!s.length&&s}function gn(n,t,e){for(var r,i=[],s=n.length-1,o=0;o<s;++o)(r=un(n[o],n[o+1],t,e))&&i.push(r);return!!i.length&&i}function xn(n,t,e){for(var r,i=[],s=n.length-1,o=Vn(t,e),a=0;a<s;++a)(r=ln(n[a],n[a+1],o))&&i.push.apply(i,r);return!!i.length&&i}function dn(n,t,e,r,i){for(var s,o=[],a=n.length-1,u=An(t,e,r,i),l=0;l<a;++l)(s=cn(n[l],n[l+1],u))&&o.push.apply(o,s);return!!o.length&&o}function pn(n,t,e,r,i,s,o){for(var a,u=[],l=n.length-1,c=An(t,e,r,i),h=0;h<l;++h)(a=hn(n[h],n[h+1],c,t,e,r,i,s,o))&&u.push.apply(u,a);return!!u.length&&u}function mn(n,t){for(var e,r=[],i=n.length-1,s=jn(t),o=0;o<i;++o)(e=fn(n[o],n[o+1],s,t))&&r.push.apply(r,e);return!!r.length&&r}function vn(n,t){for(var e,r=[],i=n.length-1,s=Xn(t),o=0;o<i;++o)(e=yn(n[o],n[o+1],s,t))&&r.push.apply(r,e);return!!r.length&&r}function bn(n,t){for(var e,r,i=[],s=n.length-1,o=t.length-1,a=0;a<s;++a)for(e=0;e<o;++e)(r=un(n[a],n[a+1],t[e],t[e+1]))&&i.push(r);return!!i.length&&i}function Cn(n){for(var t,e,r=0,i=0,s=n.length-1;i<s;++i)t=n[i],e=n[i+1],r+=Qn(t.x-e.x,t.y-e.y);return r}function $n(t){var n=t.length;if(n<3)return t;var r=t[0],e=0;t.forEach(function(n,t){(n.y<r.y||Bn(n.y,r.y)&&n.x<r.x)&&(r=n,e=t)}),t.splice(e,1),--n;for(var i=t.map(function(n,t){return[(e=r,n=n,(e=P.atan2(n.y-e.y,n.x-e.x))<0?e+$:e),t];var e}).sort(rt).map(function(n){return t[n[1]]}),s=[r,i[0],i[1]],o=3,a=2;a<n;++a){for(;0<=U(i[a],s[o-1],s[o-2]);)s.pop(),--o;s.push(i[a]),++o}return s}function wn(n){var t=n.length;if(t<3)return!1;var e,r,i=n[t-2].x,s=n[t-2].y,o=n[t-1].x,a=n[t-1].y,u=P.atan2(a-s,o-i),l=0,c=0,h=0;for(ndx=0;ndx<t;++ndx){if(i=o,s=a,e=u,o=(r=n[ndx]).x,a=r.y,(c=(u=P.atan2(a-s,o-i))-e)<=-C?c+=$:C<c&&(c-=$),0===ndx){if(0===c)return!1;h=0<c?1:-1}else if(h*c<=0)return!1;l+=c}return 1===G(P.round(l/$))}function _n(n,t){return!On(n,0)&&[-t/n]}function kn(n,t,e){if(On(n,0))return _n(t,e);var r=t*t-4*n*e,e=0;return Bn(r,0)?[-t/(2*n)]:!(r<0)&&[(-t-(e=b(r)))/(2*n),(-t+e)/(2*n)]}function Sn(n,t,e,r){if(On(n,0))return kn(t,e,r);var i,s=t/n,o=e/n,a=(3*o-s*s)/9,u=(9*s*o-27*(r/n)-2*l(s,3))/54,t=l(a,3)+l(u,2),e=0,r=0,n=0;return 0<=t?(o=Ln(u+(e=b(t)))*l(G(u+e),1/3),r=Ln(u-e)*l(G(u-e),1/3),Bn(G(c*(o-r)/2),0)?[-s/3+(o+r),-s/3-(o+r)/2]:[-s/3+(o+r)]):(n=P.acos(u/b(-l(a,3))),[(i=2*b(-a))*P.cos(n/3)-s/3,i*P.cos((n+$)/3)-s/3,i*P.cos((n+2*$)/3)-s/3])}function Pn(n,t,e,r,i,s){var o=n*i-t*r;return!On(o,0)&&{x:(t*s-e*i)/o,y:(e*r-n*s)/o}}function Gn(n,t,e,r,i,s,o,a,u){var l,c,h,f,y;return On(n,0)?!!(l=_n(t,e))&&(!!(l=kn(r,s*(c=l[0])+o,i*c*c+a*c+u))&&(2===l.length?[{x:l[0],y:c},{x:l[1],y:c}]:[{x:l[0],y:c}])):!On(f=2*(r*t*t+i*n*n-s*n*t),0)&&(!((h=-4*r*i*e*e+4*r*a*e*t-4*r*u*t*t+4*i*o*e*n-4*i*u*n*n+s*s*e*e-2*s*o*e*t-2*s*a*e*n+4*s*u*n*t+o*o*t*t-2*o*a*n*t+a*a*n*n)<0)&&(y=2*r*e*t-s*e*n-o*n*t+a*n*n,On(h,0)?[{x:-(e+t*(-y/f))/n,y:-y/f}]:[{x:-(e+t*((-n*(h=b(h))-y)/f))/n,y:(-n*h-y)/f},{x:-(e+t*((n*h-y)/f))/n,y:(n*h-y)/f}]))}function Vn(n,t){var e=n.x,n=n.y;return[1,1,0,-2*e,-2*n,e*e+n*n-t*t]}function An(n,t,e,r){var i=n.x,s=n.y,o=r[0],a=r[1],n=t*t*a*a+e*e*o*o,r=t*t*o*o+e*e*a*a,o=2*(e*e-t*t)*a*o;return[n,r,o,-2*n*i-o*s,-o*i-2*r*s,n*i*i+o*i*s+r*s*s-t*t*e*e]}function jn(n){return[n[0].y*n[0].y-4*n[0].y*n[1].y+2*n[0].y*n[2].y+4*n[1].y*n[1].y-4*n[1].y*n[2].y+n[2].y*n[2].y,n[0].x*n[0].x-4*n[0].x*n[1].x+2*n[0].x*n[2].x+4*n[1].x*n[1].x-4*n[1].x*n[2].x+n[2].x*n[2].x,-2*n[0].x*n[0].y+4*n[0].x*n[1].y-2*n[0].x*n[2].y+4*n[1].x*n[0].y-8*n[1].x*n[1].y+4*n[1].x*n[2].y-2*n[2].x*n[0].y+4*n[2].x*n[1].y-2*n[2].x*n[2].y,2*n[0].x*n[0].y*n[2].y-4*n[0].x*n[1].y*n[1].y+4*n[0].x*n[1].y*n[2].y-2*n[0].x*n[2].y*n[2].y+4*n[1].x*n[0].y*n[1].y-8*n[1].x*n[0].y*n[2].y+4*n[1].x*n[1].y*n[2].y-2*n[2].x*n[0].y*n[0].y+4*n[2].x*n[0].y*n[1].y+2*n[2].x*n[0].y*n[2].y-4*n[2].x*n[1].y*n[1].y,-2*n[0].x*n[0].x*n[2].y+4*n[0].x*n[1].x*n[1].y+4*n[0].x*n[1].x*n[2].y+2*n[0].x*n[2].x*n[0].y-8*n[0].x*n[2].x*n[1].y+2*n[0].x*n[2].x*n[2].y-4*n[1].x*n[1].x*n[0].y-4*n[1].x*n[1].x*n[2].y+4*n[1].x*n[2].x*n[0].y+4*n[1].x*n[2].x*n[1].y-2*n[2].x*n[2].x*n[0].y,n[0].x*n[0].x*n[2].y*n[2].y-4*n[0].x*n[1].x*n[1].y*n[2].y-2*n[0].x*n[2].x*n[0].y*n[2].y+4*n[0].x*n[2].x*n[1].y*n[1].y+4*n[1].x*n[1].x*n[0].y*n[2].y-4*n[1].x*n[2].x*n[0].y*n[1].y+n[2].x*n[2].x*n[0].y*n[0].y]}function Xn(n){return[{x:-n[0].x+3*n[1].x-3*n[2].x+n[3].x,y:-n[0].y+3*n[1].y-3*n[2].y+n[3].y},{x:3*n[0].x-6*n[1].x+3*n[2].x,y:3*n[0].y-6*n[1].y+3*n[2].y},{x:-3*n[0].x+3*n[1].x,y:-3*n[0].y+3*n[1].y},{x:n[0].x,y:n[0].y}]}function Yn(n,t,e){e=e||0;return(1-e)*n+e*t}function Tn(n,t){var e=1-n;return{x:e*t[0].x+n*t[1].x,y:e*t[0].y+n*t[1].y}}function zn(n,t){var e=1-n,r=e*e,e=2*e*n,n=n*n;return{x:r*t[0].x+e*t[1].x+n*t[2].x,y:r*t[0].y+e*t[1].y+n*t[2].y}}function Fn(n,t){var e=1-n,r=n*n,i=e*e,s=e*i,o=r*n,n=3*i*n,r=3*e*r;return{x:s*t[0].x+n*t[1].x+r*t[2].x+o*t[3].x,y:s*t[0].y+n*t[1].y+r*t[2].y+o*t[3].y}}function qn(n,t,e,r,i,s,o){null==s&&(s=1,o=0),null==i&&(i=r);r*=P.cos(n),n=i*P.sin(n);return{x:t+s*r-o*n,y:e+o*r+s*n}}function En(n,t,e,r,i,s,o,a){return null==o&&(o=1,a=0),null==s&&(s=i),{x:e+o*(n*=i)-a*(t*=s),y:r+a*n+o*t}}function Mn(n,t,e,r,i,s,o,a,u){null==o&&(o=1,a=0),null==s&&(s=i);var l=Bn(2*G(t),C)?.551915024494*Ln(t):4*P.tan(t/4)/3,c=P.cos(n),h=P.sin(n),f=P.cos(n+t),t=P.sin(n+t);return u?[En(f,t,e,r,i,s,o,a),En(f+t*l,t-f*l,e,r,i,s,o,a),En(c-h*l,h+c*l,e,r,i,s,o,a),En(c,h,e,r,i,s,o,a)]:[En(c,h,e,r,i,s,o,a),En(c-h*l,h+c*l,e,r,i,s,o,a),En(f+t*l,t-f*l,e,r,i,s,o,a),En(f,t,e,r,i,s,o,a)]}function On(n,t){return G(n-t)<Number.EPSILON}function Bn(n,t,e){return null==e&&(e=r),G(n-t)<e}function In(n,t,e){return P.max(P.min(n,e),t)}function Ln(n){return n<0?-1:1}function Rn(n,t){return n<0?ct(n):(!1===t?"":"+")+ct(n)}function Nn(n){return 180*n/C}function Wn(n){return n*C/180}n.Plane=F;var Qn=function(n,t){n=G(n),t=G(t);var e=0;return 0===n?t:0===t?n:n<t?n*b(1+(e=t/n)*e):t<n?t*b(1+(e=n/t)*e):n*i};function Dn(n,t,e,r){return n*e+t*r}function Hn(n,t,e,r){return n*r-t*e}function Un(n,t,e,r){var i=Qn(n,t),s=Qn(e,r);return 0===i||0===s?0:P.acos((n*e+t*r)/i/s)}function Jn(n,t,e,r){return Ln(n*r-t*e)*Un(n,t,e,r)}function Kn(n,t,e){if(n)n.forEach(function(n){p.call(e,n)&&(t[n]=e[n])});else for(var r in e)p.call(e,r)&&(t[r]=e[r]);return t}function Zn(n,e,t,r){var i=!1;if(e=e||m,y&&!1!==t){if(!t&&(i=!0,t=document.createElementNS("http://www.w3.org/2000/svg",n),r))for(var s=0,o=r.length;s<o;++s)t.appendChild(r[s]);Object.keys(e).forEach(function(n){(i||e[n][1])&&t.setAttribute(n,e[n][0])})}else t="<"+n+" "+Object.keys(e).reduce(function(n,t){return n+t+'="'+ct(e[t][0])+'" '},"")+(r?">"+ct(r)+"</"+n+">":"/>");return t}function nt(o,a,u,i){if(pt(o.onChange))return o;function l(t){o.$cb.forEach(function(n){n(t)})}var c=!0;i=i||et;var h=function(n,t){for(var e=n;e<t;++e)!function(e){var n=ct(e),r=o[e];v(o,n,{get:function(){return r},set:function(n){a&&(n=a(n));var t=!i(r,n);u&&u(r),r=n,t&&c&&l({target:o,method:"set",added:{from:e,to:e}})},enumerable:!0})}(e)};if(o.$cb=[],o.onChange=function(n,t){var e;pt(n)&&(!1===t?-1!==(e=o.$cb.indexOf(n))&&o.$cb.splice(e,1):-1!==(e=o.$cb.indexOf(n))&&o.$cb.push(n))},a&&o.length)for(var n=0,t=o.length;n<t;++n)o[n]=a(o[n]);return["push","pop","shift","unshift","splice"].forEach(function(n){var s;o[n]=(s=n,function(){var n,t,e=arguments,r=null,i=o.length;return a&&("push"!==s&&"unshift"!==s||(e=Array.prototype.map.apply(e,a)),"splice"===s&&2<e.length&&(e=Array.prototype.slice.call(e,0,2).concat(Array.prototype.slice.call(e,2).map(a)))),"shift"!==s&&"unshift"!==s&&"splice"!==s||(c=!1),n=Array.prototype[s].apply(o,e),"splice"===s&&n.length?r=n:(0<i&&"pop"===s||"shift"===s)&&(r=[n]),r&&u&&r.forEach(u),"unshift"!==s&&"splice"!==s||(c=!0),t=o.length,("push"===s||"unshift"===s||"splice"===s)&&i<t&&h(i,t),"push"===s?l({target:o,method:s,added:{from:i,to:t}}):"unshift"===s?l({target:o,method:s,added:{from:0,to:t-i-1}}):"splice"===s&&2<e.length?l({target:o,method:s,added:{from:e[0],to:e[0]+e.length-3},deleted:r}):l({target:o,method:s,deleted:r}),n})}),h(0,o.length),o}function tt(t,n){if(!pt(t.onChange))return t;delete t.$cb,delete t.onChange,["push","pop","shift","unshift","splice"].forEach(function(n){t[n]=Array.prototype[n]});n=n?t.map(n):t.slice();return t.length=0,t.push.apply(t,n),t}function et(n,t){return n===t}function rt(n,t){return n[0]-t[0]}function it(n){return n.x}function st(n){return n.y}var ot=/^\s+|\s+$/gm,at=String.prototype.trim?function(n){return n.trim()}:function(){return s.replace(ot,"")};function ut(n,t,e,r){var i=ct(n),s=i.length,n="";return s<t&&(e=e||" ",n=new Array(t-s+1).join(e),i=r?i+n:n+i),i}var lt=0,ct=String;function ht(n){return+n||0}function ft(n){return pt(n.toTex)?n.toTex():n.toString()}function yt(n){return!isNaN(+n)}function gt(n){return"string"==typeof n||"[object String]"===t.call(n)}function xt(n){return"[object Array]"===t.call(n)}function dt(n){return"[object Object]"===t.call(n)&&"function"==typeof n.constructor&&"Object"===n.constructor.name}function pt(n){return"function"==typeof n}return n.Math.deg=Nn,n.Math.rad=Wn,n.Math.hypot=Qn,n.Math.solveLinear=_n,n.Math.solveQuadratic=kn,n.Math.solveCubic=Sn,n.Math.solveLinearLinear=Pn,n.Math.solveLinearQuadratic=Gn,n.Geometry.linearBezierCurve=Tn,n.Geometry.quadraticBezierCurve=zn,n.Geometry.cubicBezierCurve=Fn,n.Geometry.ellipticArcCurve=qn,n.Geometry.computeConvexHull=function(n){return $n(n).map(T)},n});